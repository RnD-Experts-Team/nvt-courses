import{d as T,C as q,r as w,c as G,z as J,a as u,o as n,b as t,w as a,e as l,u as e,P as C,f as r,j as K,h as v,F as b,i as h,g as S,t as d,n as $}from"./app-De5aCyOy.js";import{V as O,f as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import{_ as U,a as V,b as F,c as B,d as y}from"./SelectValue.vue_vue_type_script_setup_true_lang-D84q5NJt.js";import{_ as k}from"./Card.vue_vue_type_script_setup_true_lang-D592-r3Y.js";import{_ as A}from"./CardContent.vue_vue_type_script_setup_true_lang-BnfRKYb9.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-B9pSfhlq.js";import{_ as L}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3o6pLjC.js";import{_ as R}from"./Checkbox.vue_vue_type_script_setup_true_lang-CJs0Ik0y.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import{_ as p}from"./Label.vue_vue_type_script_setup_true_lang-BhPM2rb2.js";import{_ as W}from"./Input.vue_vue_type_script_setup_true_lang-XEyr05A5.js";import{_ as X,a as Y}from"./index-Bl7hX8X-.js";import{A as Z}from"./arrow-left-kG5YrchA.js";import{U as ee,_ as se}from"./_plugin-vue_export-helper-DsuA5ZjC.js";import{F as te}from"./filter-Ihqwk31P.js";import{S as ae}from"./send-fhPUJJ3W.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";import"./clock-BXDw5ZYb.js";import"./useForwardPropsEmits-Cp6q3zLn.js";import"./Presence-DbAr2sRl.js";import"./ConfigProvider-B6_1veax.js";import"./useForwardExpose-Cyi8rQxf.js";import"./Teleport-swefm16Y.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-CPyPlHCY.js";import"./Collection-BDp_B7Ge.js";import"./usePrimitiveElement-B41iOtr7.js";import"./check-DTkWFW74.js";import"./useSize-CHi05SbU.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-9kO_gd9f.js";const oe={class:"max-w-4xl mx-auto space-y-6"},ie={class:"flex items-center gap-4"},le={class:"flex flex-col"},re={class:"text-xs text-muted-foreground"},ne={key:0,class:"text-destructive text-sm"},de={class:"space-y-4 p-4 bg-muted/50 rounded-lg"},ue={class:"flex items-center gap-2 text-sm font-medium"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ce={class:"space-y-2"},fe={class:"space-y-2"},_e={class:"space-y-3"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-80 overflow-y-auto"},ge={class:"text-sm font-medium text-foreground block truncate"},xe={class:"text-xs text-muted-foreground block truncate"},ve={key:0,class:"text-xs text-muted-foreground block truncate"},be={key:0,class:"text-destructive text-sm"},he={class:"flex justify-between items-center"},ye={class:"text-sm text-muted-foreground"},ke={class:"font-medium"},Ae={key:0,class:"ml-2"},we={class:"flex gap-2"},Ce={class:"flex flex-col sm:flex-row gap-4 pt-6 border-t"},Se={key:0},$e={key:1},Ue={key:2},Ve=T({__name:"Create",props:{audios:{},users:{},departments:{}},setup(N){const z=N,M=[{title:"Audio Management",href:"/admin/audio"},{title:"Audio Assignments",href:"/admin/audio-assignments"},{title:"Create Assignment",href:"#"}],o=q({audio_id:"",user_ids:[]}),f=w("all"),g=w(""),x=G(()=>{let m=z.users;if(f.value&&f.value!=="all"&&(m=m.filter(s=>{var c;return((c=s.department_id)==null?void 0:c.toString())===f.value})),g.value){const s=g.value.toLowerCase();m=m.filter(c=>c.name.toLowerCase().includes(s)||c.email.toLowerCase().includes(s))}return m});function j(){o.user_ids=x.value.map(m=>m.id)}function H(){o.user_ids=[]}function I(){o.post("/admin/audio-assignments",{onSuccess:()=>{}})}return(m,s)=>{const c=J("Head");return n(),u(b,null,[t(c,{title:"Create Audio Assignment"}),t(Q,{breadcrumbs:M},{default:a(()=>[l("div",oe,[l("div",ie,[t(e(_),{asChild:"",variant:"ghost"},{default:a(()=>[t(e(C),{href:"/admin/audio-assignments"},{default:a(()=>[t(e(Z),{class:"h-4 w-4 mr-2"}),s[3]||(s[3]=r(" Back to Assignments "))]),_:1})]),_:1}),s[4]||(s[4]=l("div",null,[l("h1",{class:"text-2xl font-bold"},"Create Audio Assignment"),l("p",{class:"text-muted-foreground"},"Assign audio content to users by department")],-1))]),l("form",{onSubmit:K(I,["prevent"]),class:"space-y-6"},[t(e(k),null,{default:a(()=>[t(e(D),null,{default:a(()=>[t(e(L),{class:"flex items-center gap-2"},{default:a(()=>[t(e(O),{class:"h-5 w-5"}),s[5]||(s[5]=r(" Select Audio "))]),_:1})]),_:1}),t(e(A),{class:"space-y-3"},{default:a(()=>[t(e(p),{for:"audio-select",class:"text-sm font-semibold"},{default:a(()=>s[6]||(s[6]=[r("Audio Course *")])),_:1}),t(e(U),{modelValue:e(o).audio_id,"onUpdate:modelValue":s[0]||(s[0]=i=>e(o).audio_id=i),disabled:e(o).processing},{default:a(()=>[t(e(V),{id:"audio-select"},{default:a(()=>[t(e(F),{placeholder:"Choose an audio course to assign..."})]),_:1}),t(e(B),null,{default:a(()=>[(n(!0),u(b,null,h(m.audios,i=>(n(),S(e(y),{key:i.id,value:i.id.toString()},{default:a(()=>[l("div",le,[l("span",null,d(i.name),1),l("span",re,d(i.formatted_duration),1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),e(o).errors.audio_id?(n(),u("div",ne,d(e(o).errors.audio_id),1)):v("",!0)]),_:1})]),_:1}),t(e(k),null,{default:a(()=>[t(e(D),null,{default:a(()=>[t(e(L),{class:"flex items-center gap-2"},{default:a(()=>[t(e(ee),{class:"h-5 w-5"}),s[7]||(s[7]=r(" Select Users "))]),_:1})]),_:1}),t(e(A),{class:"space-y-4"},{default:a(()=>[l("div",de,[l("div",ue,[t(e(te),{class:"h-4 w-4"}),s[8]||(s[8]=r(" Filter Users "))]),l("div",me,[l("div",ce,[t(e(p),null,{default:a(()=>s[9]||(s[9]=[r("Filter by Department")])),_:1}),t(e(U),{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=i=>f.value=i)},{default:a(()=>[t(e(V),null,{default:a(()=>[t(e(F),{placeholder:"All Departments"})]),_:1}),t(e(B),null,{default:a(()=>[t(e(y),{value:"all"},{default:a(()=>s[10]||(s[10]=[r("All Departments")])),_:1}),(n(!0),u(b,null,h(m.departments,i=>(n(),S(e(y),{key:i.id,value:i.id.toString()},{default:a(()=>[r(d(i.name)+" ("+d(i.users_count)+" users) ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),l("div",fe,[t(e(p),{for:"name-search"},{default:a(()=>s[11]||(s[11]=[r("Search by Name")])),_:1}),t(e(W),{id:"name-search",modelValue:g.value,"onUpdate:modelValue":s[2]||(s[2]=i=>g.value=i),type:"text",placeholder:"Search users..."},null,8,["modelValue"])])])]),l("div",_e,[t(e(p),{class:"text-sm font-semibold"},{default:a(()=>s[12]||(s[12]=[r("Select Users *")])),_:1}),t(e(k),{class:"bg-muted/50"},{default:a(()=>[t(e(A),{class:"p-4"},{default:a(()=>[l("div",pe,[(n(!0),u(b,null,h(x.value,i=>(n(),u("div",{key:i.id,class:$(["flex items-center space-x-3 p-3 bg-background rounded-lg border hover:border-primary/50 hover:bg-accent/50 transition-colors cursor-pointer",{"border-primary bg-accent":e(o).user_ids.includes(i.id)}])},[t(e(R),{id:`user-${i.id}`,checked:e(o).user_ids.includes(i.id),"onUpdate:checked":P=>{P?e(o).user_ids.push(i.id):e(o).user_ids=e(o).user_ids.filter(E=>E!==i.id)},disabled:e(o).processing},null,8,["id","checked","onUpdate:checked","disabled"]),t(e(p),{for:`user-${i.id}`,class:"min-w-0 flex-1 cursor-pointer"},{default:a(()=>[l("span",ge,d(i.name),1),l("span",xe,d(i.email),1),i.department?(n(),u("span",ve,d(i.department.name),1)):v("",!0)]),_:2},1032,["for"])],2))),128))])]),_:1})]),_:1}),e(o).errors.user_ids?(n(),u("div",be,d(e(o).errors.user_ids),1)):v("",!0),l("div",he,[l("p",ye,[l("span",ke,d(e(o).user_ids.length),1),r(" user"+d(e(o).user_ids.length!==1?"s":"")+" selected ",1),x.value.length!==m.users.length?(n(),u("span",Ae," ("+d(x.value.length)+" shown) ",1)):v("",!0)]),l("div",we,[t(e(_),{type:"button",onClick:j,variant:"link",size:"sm",disabled:e(o).processing,class:"h-auto p-0 text-xs"},{default:a(()=>s[13]||(s[13]=[r(" Select All ")])),_:1},8,["disabled"]),s[15]||(s[15]=l("span",{class:"text-muted-foreground"},"|",-1)),t(e(_),{type:"button",onClick:H,variant:"link",size:"sm",disabled:e(o).processing,class:"h-auto p-0 text-xs text-muted-foreground hover:text-foreground"},{default:a(()=>s[14]||(s[14]=[r(" Clear All ")])),_:1},8,["disabled"])])])])]),_:1})]),_:1}),t(e(X),null,{default:a(()=>[t(e(Y),null,{default:a(()=>s[16]||(s[16]=[l("strong",null,"Assignment Information:",-1),r(" Selected users will receive an email notification with audio details and a direct login link. Managers will also be notified about their team members' assignments. ")])),_:1})]),_:1}),l("div",Ce,[t(e(_),{type:"submit",class:"flex-1 sm:flex-none",disabled:e(o).processing||e(o).user_ids.length===0||!e(o).audio_id},{default:a(()=>[t(e(ae),{class:"h-4 w-4 mr-2"}),e(o).processing?(n(),u("span",Se,"Sending Assignments...")):e(o).user_ids.length===0||!e(o).audio_id?(n(),u("span",$e,"Select Audio and Users")):(n(),u("span",Ue," Assign to "+d(e(o).user_ids.length)+" User"+d(e(o).user_ids.length!==1?"s":""),1))]),_:1},8,["disabled"]),t(e(_),{as:e(C),href:"/admin/audio-assignments",variant:"secondary",class:$(["flex-1 sm:flex-none",{"pointer-events-none opacity-50":e(o).processing}])},{default:a(()=>s[17]||(s[17]=[r(" Cancel ")])),_:1},8,["as","class"])])],32)])]),_:1})],64)}}}),us=se(Ve,[["__scopeId","data-v-8a4830d5"]]);export{us as default};
