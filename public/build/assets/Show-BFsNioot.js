import{d as ve,r as c,g as h,o as m,w as s,e as n,b as t,h as v,u as e,a as u,f as r,t as o,P as R,F as j,i as V,k as Y,W as G}from"./app-De5aCyOy.js";import{_ as ge}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Dj8HCjtT.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import{_ as g}from"./Card.vue_vue_type_script_setup_true_lang-D592-r3Y.js";import{_ as y}from"./CardContent.vue_vue_type_script_setup_true_lang-BnfRKYb9.js";import{_ as B}from"./CardDescription.vue_vue_type_script_setup_true_lang-7y99tksC.js";import{_ as P}from"./CardHeader.vue_vue_type_script_setup_true_lang-B9pSfhlq.js";import{_ as b}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3o6pLjC.js";import{_ as D}from"./index-CNloWqrH.js";import{c as E,e as L,B as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import{_ as T,a as F,b as J,c as Q}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DykgtCUG.js";import{_ as he}from"./DialogDescription.vue_vue_type_script_setup_true_lang-CQOeOJ-N.js";import{_ as Z}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BoeL_UG-.js";import{_ as ee,a as te,b as se,c as ae,d as C}from"./SelectValue.vue_vue_type_script_setup_true_lang-D84q5NJt.js";import{_ as ne}from"./Label.vue_vue_type_script_setup_true_lang-BhPM2rb2.js";import{_ as ye,a as we,b as be,c as Ce,d as $e,e as ke,f as Me,g as Se}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-Dlh8pIcV.js";import{_ as Ae,a as Ue}from"./index-Bl7hX8X-.js";import{_ as Re}from"./Separator.vue_vue_type_script_setup_true_lang-DdEZmx_q.js";import{S as je}from"./square-pen-C_ROzota.js";import{P as I}from"./plus-BEctqVRE.js";import{U as le}from"./_plugin-vue_export-helper-DsuA5ZjC.js";import{U as z}from"./user-D0HtPb4E.js";import{B as Ve}from"./book-open-pPANAQ7D.js";import{T as Pe}from"./trash-2-cH28u5cA.js";import{E as re}from"./external-link-Blg3pbjp.js";import{C as oe}from"./circle-alert-Ld7mL4Bp.js";import{I as ie}from"./info-DQSsXDH1.js";import{C as De}from"./circle-x-qrbwyPjC.js";import{C as Ee}from"./circle-check-big-BYC-wlwA.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";import"./clock-BXDw5ZYb.js";import"./useForwardPropsEmits-Cp6q3zLn.js";import"./Presence-DbAr2sRl.js";import"./ConfigProvider-B6_1veax.js";import"./useForwardExpose-Cyi8rQxf.js";import"./Teleport-swefm16Y.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-CPyPlHCY.js";import"./Collection-BDp_B7Ge.js";import"./usePrimitiveElement-B41iOtr7.js";import"./check-DTkWFW74.js";import"./useSize-CHi05SbU.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-9kO_gd9f.js";const Le={class:"px-4 sm:px-0 space-y-6"},Ne={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Be={class:"flex items-center space-x-4"},Te={class:"mt-2 flex items-center flex-wrap gap-4 text-sm text-muted-foreground"},Fe={key:0},Ie={class:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto"},ze={key:0},Oe={class:"text-sm text-muted-foreground"},qe={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},We={class:"flex items-center"},He={class:"shrink-0"},Ke={class:"w-8 h-8 bg-primary rounded-md flex items-center justify-center"},Xe={class:"ml-5 w-0 flex-1"},Ye={class:"text-lg font-medium"},Ge={class:"flex items-center"},Je={class:"shrink-0"},Qe={class:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center"},Ze={class:"ml-5 w-0 flex-1"},et={class:"text-lg font-medium"},tt={class:"flex items-center"},st={class:"shrink-0"},at={class:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center"},nt={class:"ml-5 w-0 flex-1"},lt={class:"text-lg font-medium"},rt={class:"flex items-center"},ot={class:"shrink-0"},it={class:"w-8 h-8 bg-orange-500 rounded-md flex items-center justify-center"},dt={class:"ml-5 w-0 flex-1"},mt={class:"text-lg font-medium"},ut={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ft={class:"divide-y divide-border"},ct={class:"flex items-center justify-between"},_t={class:"flex items-center space-x-4"},pt={class:"min-w-0 flex-1"},vt={class:"flex items-center space-x-2"},gt={class:"text-sm font-medium truncate"},xt={class:"mt-1 flex items-center space-x-2"},ht={class:"text-xs text-muted-foreground"},yt={class:"text-xs text-muted-foreground mt-1"},wt={class:"text-xs text-muted-foreground mt-1"},bt={key:0,class:"p-6 text-center"},Ct={class:"mt-6"},$t={class:"divide-y divide-border max-h-96 overflow-y-auto"},kt={class:"flex items-center space-x-4"},Mt={class:"min-w-0 flex-1"},St={class:"text-sm font-medium truncate"},At={class:"mt-1 flex items-center space-x-2"},Ut={key:1,class:"text-xs text-muted-foreground"},Rt={class:"text-xs text-muted-foreground mt-1"},jt={key:0,class:"p-6 text-center"},Vt={class:"mt-6"},Pt={class:"divide-y divide-border"},Dt={class:"flex items-center justify-between"},Et={class:"flex items-center space-x-4"},Lt={class:"min-w-0 flex-1"},Nt={class:"text-sm font-medium"},Bt={class:"text-sm text-muted-foreground mt-1"},Tt={class:"mt-2 flex items-center space-x-4 text-xs text-muted-foreground"},Ft={class:"space-y-4 py-4"},It={class:"space-y-2"},zt={class:"space-y-2"},Ot={class:"py-4"},qt={class:"flex items-center justify-center py-6"},Ts=ve({__name:"Show",props:{department:Object,managerRoles:Array,users:Array},setup(i){const $=i,S=c(!1),N=c(!1),A=c(!1),f=c(!1),p=c(""),x=c(""),O=c([]),k=c({type:"info",title:"",message:""}),M=c({title:"",message:"",action:null}),U=c({message:"Loading..."}),w=(d,a,l)=>{k.value={type:d,title:a,message:l},N.value=!0},de=(d,a,l)=>{M.value={title:d,message:a,action:l},A.value=!0},me=d=>{de("Remove Manager Role","Are you sure you want to remove this manager role? This action cannot be undone.",()=>{f.value=!0,U.value.message="Removing manager role...",G.delete(route("admin.departments.remove-manager",{department:$.department.id,role:d}),{preserveState:!0,onSuccess:()=>{f.value=!1,w("success","Success","Manager role removed successfully!")},onError:a=>{f.value=!1,console.error("Remove failed:",a),w("error","Error","Failed to remove manager role. Please try again.")}})})},q=async()=>{try{f.value=!0,U.value.message="Loading available managers...";const d=await fetch(route("admin.departments.manager-candidates",$.department.id));O.value=await d.json(),f.value=!1,S.value=!0}catch(d){f.value=!1,console.error("Failed to load manager candidates:",d),w("error","Error","Failed to load manager candidates. Please try again.")}},ue=()=>{if(!x.value||!p.value){w("warning","Validation Error","Please select both manager and role type.");return}f.value=!0,U.value.message="Assigning manager...",G.post(route("admin.departments.assign-manager",$.department.id),{user_id:x.value,role_type:p.value,is_primary:p.value==="director"},{preserveState:!0,onSuccess:()=>{f.value=!1,S.value=!1,x.value="",p.value="",w("success","Success","Manager assigned successfully!")},onError:d=>{f.value=!1,console.error("Assign failed:",d),w("error","Error","Failed to assign manager. Please try again.")}})},fe=()=>{A.value=!1,M.value.action&&M.value.action()},W=()=>{N.value=!1},H=()=>{A.value=!1},K=()=>{S.value=!1,x.value="",p.value=""},ce=d=>({direct_manager:"secondary",project_manager:"outline",director:"default",senior_manager:"destructive",supervisor:"secondary"})[d]||"outline",_e=d=>d&&{L1:"secondary",L2:"outline",L3:"secondary",L4:"destructive"}[d]||"outline",X=d=>({success:Ee,error:De,warning:oe,info:ie})[d]||ie,pe=[{name:"Dashboard",href:route("dashboard")},{name:"Departments",href:route("admin.departments.index")},{name:$.department.name,href:route("admin.departments.show",$.department.id)}];return(d,a)=>(m(),h(ge,{breadcrumbs:pe},{default:s(()=>[n("div",Le,[t(e(g),null,{default:s(()=>[t(e(P),null,{default:s(()=>[n("div",Ne,[n("div",Be,[t(e(E),{class:"h-16 w-16"},{default:s(()=>[t(e(L),{class:"bg-primary/10 text-primary text-lg font-bold"},{default:s(()=>[r(o(i.department.department_code),1)]),_:1})]),_:1}),n("div",null,[t(e(b),{class:"text-2xl"},{default:s(()=>[r(o(i.department.name),1)]),_:1}),t(e(B),{class:"mt-1"},{default:s(()=>[r(o(i.department.description),1)]),_:1}),n("div",Te,[n("span",null,[a[2]||(a[2]=n("strong",null,"Code:",-1)),r(" "+o(i.department.department_code),1)]),i.department.parent_name?(m(),u("span",Fe,[a[3]||(a[3]=n("strong",null,"Parent:",-1)),r(" "+o(i.department.parent_name),1)])):v("",!0),t(e(D),{variant:i.department.is_active?"default":"destructive"},{default:s(()=>[r(o(i.department.is_active?"Active":"Inactive"),1)]),_:1},8,["variant"])])])]),n("div",Ie,[t(e(_),{asChild:"",class:"w-full sm:w-auto"},{default:s(()=>[t(e(R),{href:d.route("admin.departments.edit",i.department.id)},{default:s(()=>[t(e(je),{class:"h-4 w-4 mr-2"}),a[4]||(a[4]=r(" Edit Department "))]),_:1},8,["href"])]),_:1}),t(e(_),{onClick:q,variant:"outline",class:"w-full sm:w-auto"},{default:s(()=>[t(e(I),{class:"h-4 w-4 mr-2"}),a[5]||(a[5]=r(" Add Manager "))]),_:1})])]),i.department.hierarchy_path?(m(),u("div",ze,[t(e(Re),{class:"my-4"}),n("div",Oe,[a[6]||(a[6]=n("strong",null,"Hierarchy:",-1)),r(" "+o(i.department.hierarchy_path),1)])])):v("",!0)]),_:1})]),_:1}),n("div",qe,[t(e(g),null,{default:s(()=>[t(e(y),{class:"p-6"},{default:s(()=>[n("div",We,[n("div",He,[n("div",Ke,[t(e(le),{class:"h-5 w-5 text-primary-foreground"})])]),n("div",Xe,[a[7]||(a[7]=n("p",{class:"text-sm font-medium text-muted-foreground truncate"},"Total Users",-1)),n("p",Ye,o(i.users.length),1)])])]),_:1})]),_:1}),t(e(g),null,{default:s(()=>[t(e(y),{class:"p-6"},{default:s(()=>[n("div",Ge,[n("div",Je,[n("div",Qe,[t(e(z),{class:"h-5 w-5 text-white"})])]),n("div",Ze,[a[8]||(a[8]=n("p",{class:"text-sm font-medium text-muted-foreground truncate"},"Manager Roles",-1)),n("p",et,o(i.managerRoles.length),1)])])]),_:1})]),_:1}),t(e(g),null,{default:s(()=>[t(e(y),{class:"p-6"},{default:s(()=>[n("div",tt,[n("div",st,[n("div",at,[t(e(xe),{class:"h-5 w-5 text-white"})])]),n("div",nt,[a[9]||(a[9]=n("p",{class:"text-sm font-medium text-muted-foreground truncate"},"Sub-Departments",-1)),n("p",lt,o(i.department.children_count||0),1)])])]),_:1})]),_:1}),t(e(g),null,{default:s(()=>[t(e(y),{class:"p-6"},{default:s(()=>[n("div",rt,[n("div",ot,[n("div",it,[t(e(Ve),{class:"h-5 w-5 text-white"})])]),n("div",dt,[a[10]||(a[10]=n("p",{class:"text-sm font-medium text-muted-foreground truncate"},"Active Courses",-1)),n("p",mt,o(i.department.active_courses||0),1)])])]),_:1})]),_:1})]),n("div",ut,[t(e(g),null,{default:s(()=>[t(e(P),null,{default:s(()=>[t(e(b),null,{default:s(()=>a[11]||(a[11]=[r("Manager Roles")])),_:1})]),_:1}),t(e(y),{class:"p-0"},{default:s(()=>[n("div",ft,[(m(!0),u(j,null,V(i.managerRoles,l=>(m(),u("div",{key:l.id,class:"p-6"},[n("div",ct,[n("div",_t,[t(e(E),null,{default:s(()=>[t(e(L),null,{default:s(()=>[r(o(l.manager.name.charAt(0).toUpperCase()),1)]),_:2},1024)]),_:2},1024),n("div",pt,[n("div",vt,[n("p",gt,o(l.manager.name),1),l.is_primary?(m(),h(e(D),{key:0,variant:"default"},{default:s(()=>a[12]||(a[12]=[r(" Primary ")])),_:1})):v("",!0)]),n("div",xt,[t(e(D),{variant:ce(l.role_type)},{default:s(()=>[r(o(l.role_display),1)]),_:2},1032,["variant"]),n("span",ht,o(l.manager.level),1)]),n("p",yt,o(l.manager.email),1),n("p",wt," Started: "+o(l.start_date),1)])]),t(e(_),{onClick:Wt=>me(l.id),variant:"ghost",size:"sm",class:"text-destructive hover:text-destructive"},{default:s(()=>[t(e(Pe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])]))),128)),i.managerRoles.length===0?(m(),u("div",bt,[t(e(z),{class:"mx-auto h-12 w-12 text-muted-foreground"}),t(e(b),{class:"mt-2 text-sm"},{default:s(()=>a[13]||(a[13]=[r("No managers assigned")])),_:1}),t(e(B),{class:"mt-1"},{default:s(()=>a[14]||(a[14]=[r("Start by adding a manager to this department.")])),_:1}),n("div",Ct,[t(e(_),{onClick:q},{default:s(()=>[t(e(I),{class:"h-4 w-4 mr-2"}),a[15]||(a[15]=r(" Add Manager "))]),_:1})])])):v("",!0)])]),_:1})]),_:1}),t(e(g),null,{default:s(()=>[t(e(P),null,{default:s(()=>[t(e(b),null,{default:s(()=>a[16]||(a[16]=[r("Department Users")])),_:1})]),_:1}),t(e(y),{class:"p-0"},{default:s(()=>[n("div",$t,[(m(!0),u(j,null,V(i.users,l=>(m(),u("div",{key:l.id,class:"p-6"},[n("div",kt,[t(e(E),null,{default:s(()=>[t(e(L),null,{default:s(()=>[r(o(l.name.charAt(0).toUpperCase()),1)]),_:2},1024)]),_:2},1024),n("div",Mt,[n("p",St,o(l.name),1),n("div",At,[l.level?(m(),h(e(D),{key:0,variant:_e(l.level)},{default:s(()=>[r(o(l.level),1)]),_:2},1032,["variant"])):v("",!0),l.employee_code?(m(),u("span",Ut," ID: "+o(l.employee_code),1)):v("",!0)]),n("p",Rt,o(l.email),1)]),t(e(_),{asChild:"",variant:"ghost",size:"sm"},{default:s(()=>[t(e(R),{href:d.route("admin.users.organizational",l.id)},{default:s(()=>[t(e(re),{class:"h-4 w-4"})]),_:2},1032,["href"])]),_:2},1024)])]))),128)),i.users.length===0?(m(),u("div",jt,[t(e(le),{class:"mx-auto h-12 w-12 text-muted-foreground"}),t(e(b),{class:"mt-2 text-sm"},{default:s(()=>a[17]||(a[17]=[r("No users assigned")])),_:1}),t(e(B),{class:"mt-1"},{default:s(()=>a[18]||(a[18]=[r("Users need to be assigned to this department.")])),_:1}),n("div",Vt,[t(e(_),{asChild:""},{default:s(()=>[t(e(R),{href:d.route("admin.users.assignment")},{default:s(()=>[t(e(I),{class:"h-4 w-4 mr-2"}),a[19]||(a[19]=r(" Assign Users "))]),_:1},8,["href"])]),_:1})])])):v("",!0)])]),_:1})]),_:1})]),i.department.children&&i.department.children.length>0?(m(),h(e(g),{key:0},{default:s(()=>[t(e(P),null,{default:s(()=>[t(e(b),null,{default:s(()=>a[20]||(a[20]=[r("Sub-Departments")])),_:1})]),_:1}),t(e(y),{class:"p-0"},{default:s(()=>[n("div",Pt,[(m(!0),u(j,null,V(i.department.children,l=>(m(),u("div",{key:l.id,class:"p-6"},[n("div",Dt,[n("div",Et,[t(e(E),null,{default:s(()=>[t(e(L),{class:"bg-primary/10 text-primary"},{default:s(()=>[r(o(l.department_code),1)]),_:2},1024)]),_:2},1024),n("div",Lt,[n("p",Nt,o(l.name),1),n("p",Bt,o(l.description),1),n("div",Tt,[n("span",null,o(l.users_count)+" users",1),n("span",null,o(l.managers_count)+" managers",1)])])]),t(e(_),{asChild:"",variant:"ghost",size:"sm"},{default:s(()=>[t(e(R),{href:d.route("admin.departments.show",l.id)},{default:s(()=>[t(e(re),{class:"h-4 w-4"})]),_:2},1032,["href"])]),_:2},1024)])]))),128))])]),_:1})]),_:1})):v("",!0)]),t(e(T),{open:S.value,"onUpdate:open":K},{default:s(()=>[t(e(F),{class:"sm:max-w-[425px]"},{default:s(()=>[t(e(J),null,{default:s(()=>[t(e(Q),{class:"flex items-center"},{default:s(()=>[t(e(z),{class:"h-5 w-5 mr-2"}),r(" Add Manager to "+o(i.department.name),1)]),_:1}),t(e(he),null,{default:s(()=>a[21]||(a[21]=[r(" Select a manager and assign them a role in this department. ")])),_:1})]),_:1}),n("div",Ft,[n("div",It,[t(e(ne),{for:"manager"},{default:s(()=>a[22]||(a[22]=[r("Manager")])),_:1}),t(e(ee),{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=l=>x.value=l)},{default:s(()=>[t(e(te),null,{default:s(()=>[t(e(se),{placeholder:"Select Manager"})]),_:1}),t(e(ae),null,{default:s(()=>[(m(!0),u(j,null,V(O.value,l=>(m(),h(e(C),{key:l.id,value:l.id.toString()},{default:s(()=>[r(o(l.name)+" ("+o(l.level)+") - "+o(l.department),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),n("div",zt,[t(e(ne),{for:"role-type"},{default:s(()=>a[23]||(a[23]=[r("Role Type")])),_:1}),t(e(ee),{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=l=>p.value=l)},{default:s(()=>[t(e(te),null,{default:s(()=>[t(e(se),{placeholder:"Select Role Type"})]),_:1}),t(e(ae),null,{default:s(()=>[t(e(C),{value:"director"},{default:s(()=>a[24]||(a[24]=[r("Director")])),_:1}),t(e(C),{value:"senior_manager"},{default:s(()=>a[25]||(a[25]=[r("Senior Manager")])),_:1}),t(e(C),{value:"direct_manager"},{default:s(()=>a[26]||(a[26]=[r("Direct Manager")])),_:1}),t(e(C),{value:"project_manager"},{default:s(()=>a[27]||(a[27]=[r("Project Manager")])),_:1}),t(e(C),{value:"supervisor"},{default:s(()=>a[28]||(a[28]=[r("Supervisor")])),_:1})]),_:1})]),_:1},8,["modelValue"])])]),t(e(Z),null,{default:s(()=>[t(e(_),{variant:"outline",onClick:K},{default:s(()=>a[29]||(a[29]=[r(" Cancel ")])),_:1}),t(e(_),{onClick:ue,disabled:!x.value||!p.value},{default:s(()=>a[30]||(a[30]=[r(" Assign Manager ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(e(T),{open:N.value,"onUpdate:open":W},{default:s(()=>[t(e(F),{class:"sm:max-w-[425px]"},{default:s(()=>[t(e(J),null,{default:s(()=>[t(e(Q),{class:"flex items-center"},{default:s(()=>[(m(),h(Y(X(k.value.type)),{class:"h-5 w-5 mr-2"})),r(" "+o(k.value.title),1)]),_:1})]),_:1}),n("div",Ot,[t(e(Ae),null,{default:s(()=>[(m(),h(Y(X(k.value.type)),{class:"h-4 w-4"})),t(e(Ue),null,{default:s(()=>[r(o(k.value.message),1)]),_:1})]),_:1})]),t(e(Z),null,{default:s(()=>[t(e(_),{onClick:W},{default:s(()=>a[31]||(a[31]=[r(" OK ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),t(e(ye),{open:A.value,"onUpdate:open":H},{default:s(()=>[t(e(we),null,{default:s(()=>[t(e(be),null,{default:s(()=>[t(e(Ce),{class:"flex items-center"},{default:s(()=>[t(e(oe),{class:"h-5 w-5 mr-2 text-destructive"}),r(" "+o(M.value.title),1)]),_:1}),t(e($e),null,{default:s(()=>[r(o(M.value.message),1)]),_:1})]),_:1}),t(e(ke),null,{default:s(()=>[t(e(Me),{onClick:H},{default:s(()=>a[32]||(a[32]=[r(" Cancel ")])),_:1}),t(e(Se),{onClick:fe,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:s(()=>a[33]||(a[33]=[r(" Yes, Remove ")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),t(e(T),{open:f.value,"onUpdate:open":()=>{}},{default:s(()=>[t(e(F),{class:"sm:max-w-[300px]"},{default:s(()=>[n("div",qt,[a[34]||(a[34]=n("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mr-3"},null,-1)),n("span",null,o(U.value.message),1)])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Ts as default};
