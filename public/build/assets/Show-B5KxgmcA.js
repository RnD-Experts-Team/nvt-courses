import{P as A,z as v,g as C,o as n,w as _,e as t,b as M,f as h,t as o,n as w,a as i,h as u,F as q,i as z,s as E,E as j,r as k,l as B,c as S,W as L}from"./app-De5aCyOy.js";import{_ as N}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Dj8HCjtT.js";import{_ as P}from"./_plugin-vue_export-helper-DsuA5ZjC.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";import"./clock-BXDw5ZYb.js";const T={components:{AdminLayout:N,Link:A},props:{attempt:{type:Object,required:!0}},setup(g){const e=k({}),d=k(!1),s=k(!1),c=k({}),p=r=>Array.isArray(r)?r.join(", "):typeof r=="string"?r:r==null?"N/A":String(r);B(()=>g.attempt.responses,r=>{r.forEach(l=>{l.question.type==="text"&&!l.is_correct&&(e.value[l.id]=l.points_earned??0)})},{immediate:!0});const b=S(()=>Object.values(e.value).some(r=>r!=null&&r!==0)),x=S(()=>Object.values(c.value).some(r=>r!==null));return{manualScores:e,saving:d,success:s,manualScoreErrors:c,hasManualScores:b,hasErrors:x,updateManualScore:(r,l)=>{const m=parseInt(l)||0;m<0||m>100?c.value[r]="Score must be between 0 and 100.":c.value[r]=null,e.value[r]=m},saveManualScores:async()=>{if(!x.value){d.value=!0,s.value=!1;try{const r=await L.put(route("admin.quiz-attempts.update",g.attempt.id),{manual_scores:Object.fromEntries(Object.entries(e.value).map(([l,m])=>[l,m]))},{preserveScroll:!0,onSuccess:()=>s.value=!0})}catch(r){console.error("Error saving scores:",r)}finally{d.value=!1,setTimeout(()=>s.value=!1,3e3)}}},formatCorrectAnswer:p,breadcrumbs:[{name:"Quizzes",route:"admin.quizzes.index"},{name:"Attempts",route:"admin.quiz-attempts.index"},{name:"Details",route:null}]}}},V={class:"mx-auto max-w-3xl py-12 sm:px-6 lg:px-8 bg-white dark:bg-gray-900 text-gray-900 dark:text-white"},O={class:"mb-8 flex items-center justify-between"},D={class:"mb-6 rounded-xl bg-white dark:bg-gray-800 p-6 shadow-sm dark:shadow-lg dark:shadow-gray-900/50 border border-gray-200 dark:border-gray-700"},Q={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},F={class:"text-sm text-gray-900 dark:text-gray-100"},U={class:"text-sm text-gray-900 dark:text-gray-100"},W={class:"text-sm text-gray-900 dark:text-gray-100"},I={class:"text-sm text-gray-900 dark:text-gray-100"},R={class:"text-sm text-gray-900 dark:text-gray-100"},Y={class:"text-sm text-gray-900 dark:text-gray-100"},G={class:"text-sm text-gray-900 dark:text-gray-100"},H={class:"rounded-xl bg-white dark:bg-gray-800 p-6 shadow-sm dark:shadow-lg dark:shadow-gray-900/50 border border-gray-200 dark:border-gray-700"},J={class:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300"},K={class:"mb-2 text-sm text-gray-900 dark:text-gray-100"},X={class:"space-y-2"},Z={class:"text-sm text-gray-900 dark:text-gray-100"},$={class:"text-sm text-gray-900 dark:text-gray-100"},tt={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},et={key:1},rt=["onUpdate:modelValue","onChange"],at={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},st={key:0,class:"mt-6"},ot=["disabled"],dt={key:0,class:"flex items-center justify-center"},nt={key:1},it={key:0,class:"mt-2 text-sm text-green-600 dark:text-green-400"},lt={key:1,class:"mt-2 text-sm text-red-600 dark:text-red-400"};function ut(g,e,d,s,c,p){const b=v("Link"),x=v("AdminLayout");return n(),C(x,{breadcrumbs:s.breadcrumbs},{default:_(()=>[t("div",V,[t("div",O,[e[2]||(e[2]=t("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"Attempt Details",-1)),M(b,{href:g.route("admin.quiz-attempts.index"),class:"inline-flex items-center rounded-lg bg-gray-100 dark:bg-gray-700 px-4 py-2 text-sm font-semibold text-gray-700 dark:text-gray-200 transition-colors duration-200 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-hidden focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500"},{default:_(()=>e[1]||(e[1]=[t("svg",{class:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),h(" Back to Attempts ")])),_:1},8,["href"])]),t("div",D,[e[11]||(e[11]=t("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"Summary",-1)),t("div",Q,[t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"User:",-1)),t("p",F,o(d.attempt.user.name)+" ("+o(d.attempt.user.email)+")",1)]),t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Quiz:",-1)),t("p",U,o(d.attempt.quiz.title),1)]),t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Auto Score:",-1)),t("p",W,o(d.attempt.score),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Manual Score:",-1)),t("p",I,o(d.attempt.manual_score??0),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Total Score:",-1)),t("p",R,o(d.attempt.total_score),1)]),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Pass Threshold:",-1)),t("p",Y,o(d.attempt.quiz.pass_threshold)+"%",1)]),t("div",null,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Status:",-1)),t("span",{class:w({"inline-flex rounded-full px-2 text-xs font-semibold leading-5":!0,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":d.attempt.passed,"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":!d.attempt.passed})},o(d.attempt.passed?"Passed":"Failed"),3)]),t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Completed At:",-1)),t("p",G,o(d.attempt.completed_at),1)])])]),t("div",H,[e[16]||(e[16]=t("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"Question Review",-1)),(n(!0),i(q,null,z(d.attempt.responses,(a,f)=>(n(),i("div",{key:f,class:"mb-6 rounded-lg bg-gray-50 dark:bg-gray-700 p-4 border border-gray-200 dark:border-gray-600"},[t("h3",J,"Question "+o(f+1)+" ("+o(a.question.points||"N/A")+" points)",1),t("p",K,o(a.question.question_text),1),t("div",X,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Your Answer:",-1)),t("p",Z,o(a.answer||"No answer"),1),e[14]||(e[14]=t("p",{class:"text-sm text-gray-700 dark:text-gray-300"},"Correct Answer(s):",-1)),t("p",$,o(s.formatCorrectAnswer(a.question.correct_answer)),1),a.question.correct_answer_explanation?(n(),i("p",tt," Explanation: "+o(a.question.correct_answer_explanation),1)):u("",!0),t("p",{class:w(["text-sm",{"text-green-700 dark:text-green-400":a.is_correct,"text-red-700 dark:text-red-400":!a.is_correct&&a.is_correct!==null}])}," Status: "+o(a.is_correct!==null?a.is_correct?"Correct":"Incorrect":"Pending (Text)"),3),a.question.type==="text"&&!a.is_correct?(n(),i("div",et,[e[12]||(e[12]=t("label",{for:"manualScore",class:"mt-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},"Manual Score (0-100):",-1)),E(t("input",{"onUpdate:modelValue":y=>s.manualScores[a.id]=y,type:"number",id:"manualScore",min:"0",max:"100",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 shadow-sm focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500 dark:focus:ring-indigo-400 sm:text-sm",placeholder:"Enter points",onChange:y=>s.updateManualScore(a.id,y.target.value)},null,40,rt),[[j,s.manualScores[a.id],void 0,{number:!0}]]),s.manualScoreErrors[a.id]?(n(),i("p",at,o(s.manualScoreErrors[a.id]),1)):u("",!0)])):u("",!0)])]))),128)),s.hasManualScores?(n(),i("div",st,[t("button",{onClick:e[0]||(e[0]=(...a)=>s.saveManualScores&&s.saveManualScores(...a)),disabled:s.saving||s.hasErrors,class:"w-full rounded-lg bg-indigo-600 dark:bg-indigo-500 px-4 py-2 text-sm font-medium text-white transition-colors duration-200 hover:bg-indigo-700 dark:hover:bg-indigo-600 focus:outline-hidden focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed"},[s.saving?(n(),i("span",dt,e[15]||(e[15]=[t("svg",{class:"mr-2 h-5 w-5 animate-spin text-white",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8h-8z"})],-1),h(" Saving... ")]))):(n(),i("span",nt,"Save Manual Scores"))],8,ot),s.success?(n(),i("div",it,"Scores saved successfully!")):u("",!0),s.hasErrors?(n(),i("div",lt,"Please fix the errors before saving.")):u("",!0)])):u("",!0)])])]),_:1},8,["breadcrumbs"])}const vt=P(T,[["render",ut],["__scopeId","data-v-cbfbfab0"]]);export{vt as default};
