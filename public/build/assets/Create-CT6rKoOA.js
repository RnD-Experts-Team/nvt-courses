import{d as Q,C as X,r as b,c as L,a as f,o as n,b as o,u as e,m as K,w as s,e as i,P,f as d,j as W,h as _,n as y,t as m,F as B,i as Y,g as w}from"./app-De5aCyOy.js";import{m as Z,f as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import{T as te,C as oe}from"./ChunkUploader-D_7KUbST.js";import{_ as p}from"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import{_ as S}from"./Card.vue_vue_type_script_setup_true_lang-D592-r3Y.js";import{_ as $}from"./CardContent.vue_vue_type_script_setup_true_lang-BnfRKYb9.js";import{_ as h}from"./CardDescription.vue_vue_type_script_setup_true_lang-7y99tksC.js";import{_ as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-B9pSfhlq.js";import{_ as D}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3o6pLjC.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-XEyr05A5.js";import{_ as u}from"./Label.vue_vue_type_script_setup_true_lang-BhPM2rb2.js";import{_ as se}from"./Textarea.vue_vue_type_script_setup_true_lang-B6XbqApa.js";import{_ as re}from"./Switch.vue_vue_type_script_setup_true_lang-Cp6QCENU.js";import{_ as le,a as ae,b as ie,c as de,d as ne}from"./SelectValue.vue_vue_type_script_setup_true_lang-D84q5NJt.js";import{_ as ue,a as T}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-DEgpz9bD.js";import{A as me}from"./arrow-left-kG5YrchA.js";import{S as fe}from"./square-play-Dd3oIFkj.js";import{H as j,C as pe}from"./hard-drive-BAYaPdCq.js";import{L as ve}from"./link-2-CuI9CBqP.js";import{L as ce}from"./loader-circle-DgBH8UyT.js";import{C as ge}from"./clock-BXDw5ZYb.js";import{X as _e}from"./_plugin-vue_export-helper-DsuA5ZjC.js";import{S as ye}from"./save-Cj1WR6gV.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";import"./useForwardPropsEmits-Cp6q3zLn.js";import"./useForwardExpose-Cyi8rQxf.js";import"./VisuallyHidden-9kO_gd9f.js";import"./VisuallyHiddenInput-CPW02NT0.js";import"./usePrimitiveElement-B41iOtr7.js";import"./Presence-DbAr2sRl.js";import"./ConfigProvider-B6_1veax.js";import"./Teleport-swefm16Y.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-CPyPlHCY.js";import"./Collection-BDp_B7Ge.js";import"./check-DTkWFW74.js";import"./useSize-CHi05SbU.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./RovingFocusItem-B6yBawHL.js";import"./circle-PDixcOb7.js";const xe={class:"max-w-4xl mx-auto space-y-6"},be={class:"flex items-center gap-4"},ke={class:"space-y-2"},Ce={key:0,class:"text-sm text-destructive"},Ve={class:"space-y-2"},we={key:0,class:"text-sm text-destructive"},Se={class:"space-y-2"},$e={key:0,class:"text-sm text-destructive"},he={key:0,class:"space-y-2"},Ue={class:"flex gap-2"},De={key:0,class:"text-sm text-destructive"},Me={key:1,class:"space-y-2"},ze={key:0,class:"text-sm text-destructive"},Fe={class:"text-sm text-muted-foreground"},Le={class:"space-y-3"},Pe={class:"grid grid-cols-3 gap-3"},Be={class:"space-y-2"},Te={class:"space-y-2"},je={class:"space-y-2"},Ne={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50 border"},Ee={class:"flex items-center gap-2"},Re={class:"text-sm text-muted-foreground"},Ae={class:"space-y-2"},Ge={class:"flex flex-wrap gap-2"},Ie={key:0,class:"text-sm text-destructive"},He={class:"text-sm text-muted-foreground"},Oe={class:"flex items-center justify-between"},qe={class:"space-y-1"},Je={class:"flex justify-between items-center"},jt=Q({__name:"Create",props:{categories:{},maxFileSize:{}},setup(N){const E=N,R=[{title:"Video Management",href:"/admin/videos"},{title:"Create Video Course",href:""}],r=X({name:"",description:"",storage_type:"google_drive",google_drive_url:"",video_data:"",duration:null,content_category_id:null,is_active:!0}),C=b(!1),V=b(!1),v=b(0),c=b(0),g=b(0),F=L(()=>Math.round((E.maxFileSize||512e3)/1024)),A=a=>{if(console.log("✅ Chunk upload complete:",a),console.log("✅ Data type:",typeof a),console.log("✅ Data keys:",a?Object.keys(a):"null"),typeof a=="string"){console.log("⚠️ Data is already a string, parsing first");try{a=JSON.parse(a)}catch(t){console.error("❌ Failed to parse data string:",t)}}r.video_data=JSON.stringify(a),console.log("✅ Stored video_data:",r.video_data)},G=a=>{console.error("❌ Chunk upload error:",a),alert("Upload failed. Please try again.")},I=a=>{console.log("Upload progress:",a+"%")},H=async()=>{if(r.google_drive_url){V.value=!0;try{console.log("Testing URL:",r.google_drive_url),await new Promise(a=>setTimeout(a,2e3)),alert("Video URL is valid!")}catch(a){console.error("URL test failed:",a),alert("Failed to validate video URL. Please check the link.")}finally{V.value=!1}}},O=L(()=>{const a=[];return v.value>0&&a.push(`${v.value}h`),c.value>0&&a.push(`${c.value}m`),g.value>0&&a.push(`${g.value}s`),a.length>0?a.join(" "):"Not set"}),M=()=>{const a=v.value*3600+c.value*60+g.value;r.duration=a>0?a:null},z=(a,t)=>{let l=parseInt(t)||0;a==="hours"?(l=Math.max(0,Math.min(99,l)),v.value=l):a==="minutes"?(l=Math.max(0,Math.min(59,l)),c.value=l):a==="seconds"&&(l=Math.max(0,Math.min(59,l)),g.value=l),M()},x=(a,t,l)=>{v.value=a,c.value=t,g.value=l,M()},q=()=>{v.value=0,c.value=0,g.value=0,M()},J=async()=>{C.value=!0,r.post("/admin/videos",{preserveScroll:!0,onFinish:()=>{C.value=!1},onSuccess:()=>{console.log("✅ Video created successfully")},onError:a=>{console.error("❌ Form errors:",a)}})};return(a,t)=>(n(),f(B,null,[o(e(K),{title:"Create Video Course"}),o(ee,{breadcrumbs:R},{default:s(()=>[i("div",xe,[i("div",be,[o(e(p),{"as-child":"",variant:"ghost"},{default:s(()=>[o(e(P),{href:"/admin/videos"},{default:s(()=>[o(e(me),{class:"h-4 w-4 mr-2"}),t[14]||(t[14]=d(" Back to Videos "))]),_:1})]),_:1}),t[15]||(t[15]=i("div",null,[i("h1",{class:"text-2xl font-bold"},"Create Video Course"),i("p",{class:"text-muted-foreground"},"Add a new video course to your library")],-1))]),i("form",{onSubmit:W(J,["prevent"]),class:"space-y-6"},[o(e(S),null,{default:s(()=>[o(e(U),null,{default:s(()=>[o(e(D),{class:"flex items-center gap-2"},{default:s(()=>[o(e(fe),{class:"h-5 w-5"}),t[16]||(t[16]=d(" Video Information "))]),_:1}),o(e(h),null,{default:s(()=>t[17]||(t[17]=[d(" Enter the basic details for your video course ")])),_:1})]),_:1}),o(e($),{class:"space-y-4"},{default:s(()=>[i("div",ke,[o(e(u),{for:"name"},{default:s(()=>t[18]||(t[18]=[d("Video Title")])),_:1}),o(e(k),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":t[0]||(t[0]=l=>e(r).name=l),type:"text",placeholder:"Enter video course title...",class:y({"border-destructive":e(r).errors.name}),required:""},null,8,["modelValue","class"]),e(r).errors.name?(n(),f("div",Ce,m(e(r).errors.name),1)):_("",!0)]),i("div",Ve,[o(e(u),{for:"description"},{default:s(()=>t[19]||(t[19]=[d("Description")])),_:1}),o(e(se),{id:"description",modelValue:e(r).description,"onUpdate:modelValue":t[1]||(t[1]=l=>e(r).description=l),placeholder:"Describe what students will learn from this video course...",rows:"5",class:y({"border-destructive":e(r).errors.description})},null,8,["modelValue","class"]),e(r).errors.description?(n(),f("div",we,m(e(r).errors.description),1)):_("",!0)]),i("div",Se,[o(e(u),{for:"content_category_id"},{default:s(()=>t[20]||(t[20]=[d("Category")])),_:1}),o(e(le),{modelValue:e(r).content_category_id,"onUpdate:modelValue":t[2]||(t[2]=l=>e(r).content_category_id=l)},{default:s(()=>[o(e(ae),{class:y({"border-destructive":e(r).errors.content_category_id})},{default:s(()=>[o(e(ie),{placeholder:"Select a category..."})]),_:1},8,["class"]),o(e(de),null,{default:s(()=>[(n(!0),f(B,null,Y(a.categories,l=>(n(),w(e(ne),{key:l.id,value:l.id.toString()},{default:s(()=>[d(m(l.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(r).errors.content_category_id?(n(),f("div",$e,m(e(r).errors.content_category_id),1)):_("",!0)])]),_:1})]),_:1}),o(e(S),null,{default:s(()=>[o(e(U),null,{default:s(()=>[o(e(D),{class:"flex items-center gap-2"},{default:s(()=>[o(e(j),{class:"h-5 w-5"}),t[21]||(t[21]=d(" Storage Type "))]),_:1}),o(e(h),null,{default:s(()=>t[22]||(t[22]=[d(" Choose where to store your video ")])),_:1})]),_:1}),o(e($),{class:"space-y-4"},{default:s(()=>[o(e(ue),{modelValue:e(r).storage_type,"onUpdate:modelValue":t[3]||(t[3]=l=>e(r).storage_type=l),class:"grid grid-cols-2 gap-4"},{default:s(()=>[o(e(u),{for:"google_drive",class:y(["flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground cursor-pointer",{"border-primary":e(r).storage_type==="google_drive"}])},{default:s(()=>[o(e(T),{value:"google_drive",id:"google_drive",class:"sr-only"}),o(e(pe),{class:"mb-3 h-6 w-6"}),t[23]||(t[23]=i("div",{class:"space-y-1 text-center"},[i("p",{class:"text-sm font-medium leading-none"},"Google Drive"),i("p",{class:"text-xs text-muted-foreground"}," Store video on Google Drive ")],-1))]),_:1},8,["class"]),o(e(u),{for:"local",class:y(["flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground cursor-pointer",{"border-primary":e(r).storage_type==="local"}])},{default:s(()=>[o(e(T),{value:"local",id:"local",class:"sr-only"}),o(e(j),{class:"mb-3 h-6 w-6"}),t[24]||(t[24]=i("div",{class:"space-y-1 text-center"},[i("p",{class:"text-sm font-medium leading-none"},"Local Storage"),i("p",{class:"text-xs text-muted-foreground"}," Upload video to server ")],-1))]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(e(S),null,{default:s(()=>[o(e(U),null,{default:s(()=>[o(e(D),{class:"flex items-center gap-2"},{default:s(()=>[o(e(ve),{class:"h-5 w-5"}),t[25]||(t[25]=d(" Video Source "))]),_:1}),o(e(h),null,{default:s(()=>[d(m(e(r).storage_type==="google_drive"?"Provide Google Drive URL":"Upload video file"),1)]),_:1})]),_:1}),o(e($),{class:"space-y-4"},{default:s(()=>[e(r).storage_type==="google_drive"?(n(),f("div",he,[o(e(u),{for:"google_drive_url"},{default:s(()=>t[26]||(t[26]=[d("Google Drive Video URL")])),_:1}),i("div",Ue,[o(e(k),{id:"google_drive_url",modelValue:e(r).google_drive_url,"onUpdate:modelValue":t[4]||(t[4]=l=>e(r).google_drive_url=l),type:"url",placeholder:"https://drive.google.com/file/d/...",class:y({"border-destructive":e(r).errors.google_drive_url})},null,8,["modelValue","class"]),o(e(p),{type:"button",variant:"outline",size:"icon",onClick:H,disabled:!e(r).google_drive_url||V.value},{default:s(()=>[V.value?(n(),w(e(ce),{key:0,class:"h-4 w-4 animate-spin"})):(n(),w(e(te),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])]),e(r).errors.google_drive_url?(n(),f("div",De,m(e(r).errors.google_drive_url),1)):_("",!0),t[27]||(t[27]=i("div",{class:"text-sm text-muted-foreground"},' Paste the shareable link from Google Drive. Make sure the video is set to "Anyone with the link can view" ',-1))])):e(r).storage_type==="local"?(n(),f("div",Me,[o(e(u),{for:"video_file"},{default:s(()=>t[28]||(t[28]=[d("Video File")])),_:1}),o(oe,{name:"file",accept:"video/*",maxFileSize:F.value+"MB",onUploaded:A,onError:G,onProgress:I},null,8,["maxFileSize"]),e(r).errors.video_file||e(r).errors.video_data?(n(),f("div",ze,m(e(r).errors.video_file||e(r).errors.video_data),1)):_("",!0),i("div",Fe," Video will be uploaded in 2MB chunks for reliability. Maximum "+m(F.value)+"MB ",1)])):_("",!0),i("div",Le,[o(e(u),null,{default:s(()=>t[29]||(t[29]=[d("Duration")])),_:1}),i("div",Pe,[i("div",Be,[o(e(u),{for:"hours",class:"text-xs text-muted-foreground"},{default:s(()=>t[30]||(t[30]=[d("Hours")])),_:1}),o(e(k),{id:"hours",type:"number",min:"0",max:"99",value:v.value,onInput:t[5]||(t[5]=l=>z("hours",l.target.value)),placeholder:"0",class:"text-center"},null,8,["value"])]),i("div",Te,[o(e(u),{for:"minutes",class:"text-xs text-muted-foreground"},{default:s(()=>t[31]||(t[31]=[d("Minutes")])),_:1}),o(e(k),{id:"minutes",type:"number",min:"0",max:"59",value:c.value,onInput:t[6]||(t[6]=l=>z("minutes",l.target.value)),placeholder:"0",class:"text-center"},null,8,["value"])]),i("div",je,[o(e(u),{for:"seconds",class:"text-xs text-muted-foreground"},{default:s(()=>t[32]||(t[32]=[d("Seconds")])),_:1}),o(e(k),{id:"seconds",type:"number",min:"0",max:"59",value:g.value,onInput:t[7]||(t[7]=l=>z("seconds",l.target.value)),placeholder:"0",class:"text-center"},null,8,["value"])])]),i("div",Ne,[i("div",Ee,[o(e(ge),{class:"h-4 w-4 text-muted-foreground"}),t[33]||(t[33]=i("span",{class:"text-sm font-medium"},"Total Duration:",-1)),i("span",Re,m(O.value),1)]),v.value>0||c.value>0||g.value>0?(n(),w(e(p),{key:0,onClick:q,variant:"ghost",size:"sm",type:"button"},{default:s(()=>[o(e(_e),{class:"h-4 w-4"})]),_:1})):_("",!0)]),i("div",Ae,[o(e(u),{class:"text-xs text-muted-foreground"},{default:s(()=>t[34]||(t[34]=[d("Quick Presets:")])),_:1}),i("div",Ge,[o(e(p),{onClick:t[8]||(t[8]=l=>x(0,5,0)),variant:"outline",size:"sm",type:"button"},{default:s(()=>t[35]||(t[35]=[d(" 5 min ")])),_:1}),o(e(p),{onClick:t[9]||(t[9]=l=>x(0,10,0)),variant:"outline",size:"sm",type:"button"},{default:s(()=>t[36]||(t[36]=[d(" 10 min ")])),_:1}),o(e(p),{onClick:t[10]||(t[10]=l=>x(0,30,0)),variant:"outline",size:"sm",type:"button"},{default:s(()=>t[37]||(t[37]=[d(" 30 min ")])),_:1}),o(e(p),{onClick:t[11]||(t[11]=l=>x(1,0,0)),variant:"outline",size:"sm",type:"button"},{default:s(()=>t[38]||(t[38]=[d(" 1 hour ")])),_:1}),o(e(p),{onClick:t[12]||(t[12]=l=>x(2,0,0)),variant:"outline",size:"sm",type:"button"},{default:s(()=>t[39]||(t[39]=[d(" 2 hours ")])),_:1})])]),e(r).errors.duration?(n(),f("div",Ie,m(e(r).errors.duration),1)):_("",!0),i("div",He,m(e(r).storage_type==="local"?"Optional - will be auto-detected from video file":"Video duration (optional)"),1)])]),_:1})]),_:1}),o(e(S),null,{default:s(()=>[o(e(U),null,{default:s(()=>[o(e(D),{class:"flex items-center gap-2"},{default:s(()=>[o(e(Z),{class:"h-5 w-5"}),t[40]||(t[40]=d(" Settings "))]),_:1}),o(e(h),null,{default:s(()=>t[41]||(t[41]=[d(" Configure the video course settings ")])),_:1})]),_:1}),o(e($),null,{default:s(()=>[i("div",Oe,[i("div",qe,[o(e(u),null,{default:s(()=>t[42]||(t[42]=[d("Active Status")])),_:1}),t[43]||(t[43]=i("div",{class:"text-sm text-muted-foreground"}," Make this video course available to students ",-1))]),o(e(re),{checked:e(r).is_active,"onUpdate:checked":t[13]||(t[13]=l=>e(r).is_active=l)},null,8,["checked"])])]),_:1})]),_:1}),i("div",Je,[o(e(p),{"as-child":"",variant:"outline"},{default:s(()=>[o(e(P),{href:"/admin/videos"},{default:s(()=>t[44]||(t[44]=[d("Cancel")])),_:1})]),_:1}),o(e(p),{type:"submit",disabled:C.value||e(r).processing||e(r).storage_type==="local"&&!e(r).video_data},{default:s(()=>[o(e(ye),{class:"h-4 w-4 mr-2"}),d(" "+m(C.value?"Creating...":"Create Video Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{jt as default};
