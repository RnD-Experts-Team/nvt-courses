import{d as G,r as z,c as L,C as O,a as c,o as n,b as l,u as t,m as E,w as d,e,P as W,f as m,t as o,g as p,h as _,F as h,i as C,n as I,W as X}from"./app-De5aCyOy.js";import{f as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import{_ as y}from"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import{_ as $}from"./Card.vue_vue_type_script_setup_true_lang-D592-r3Y.js";import{_ as S}from"./CardContent.vue_vue_type_script_setup_true_lang-BnfRKYb9.js";import{_ as J}from"./CardDescription.vue_vue_type_script_setup_true_lang-7y99tksC.js";import{_ as M}from"./CardHeader.vue_vue_type_script_setup_true_lang-B9pSfhlq.js";import{_ as U}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3o6pLjC.js";import{_ as f}from"./index-CNloWqrH.js";import{_ as K}from"./Input.vue_vue_type_script_setup_true_lang-XEyr05A5.js";import{_ as Y}from"./Label.vue_vue_type_script_setup_true_lang-BhPM2rb2.js";import{A as Z}from"./arrow-left-kG5YrchA.js";import{R as q}from"./rotate-ccw-D8-XKrTw.js";import{C as k}from"./circle-check-big-BYC-wlwA.js";import{C as T}from"./circle-x-qrbwyPjC.js";import{U as ee}from"./user-D0HtPb4E.js";import{T as te}from"./target-CkYXQ-0W.js";import{A as se}from"./award-CCJqRf4Z.js";import{C as re}from"./clock-BXDw5ZYb.js";import{S as ae}from"./save-Cj1WR6gV.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./_plugin-vue_export-helper-DsuA5ZjC.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";const le={class:"max-w-5xl mx-auto space-y-6 pb-12"},oe={class:"flex items-center justify-between gap-4"},de={class:"flex items-center gap-4"},ie={class:"text-muted-foreground"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},me={class:"space-y-3"},ue={class:"flex items-center gap-3"},ce={class:"font-medium"},pe={class:"text-sm text-muted-foreground"},fe={class:"flex items-center gap-3"},_e={class:"font-medium"},ge={class:"space-y-3"},xe={class:"flex items-center gap-3"},be={class:"font-medium text-lg"},ve={class:"text-muted-foreground text-base"},we={key:0,class:"text-xs text-muted-foreground"},he={class:"flex items-center gap-3"},ye={class:"font-medium"},ke={class:"flex items-start justify-between gap-4"},Ae={class:"flex items-start gap-3 flex-1"},ze={class:"flex-1"},Ce={class:"font-medium text-base"},$e={class:"flex items-center gap-2 mt-2"},Se={class:"text-right"},Me={key:0,class:"space-y-2 pl-12"},Ue={class:"flex items-center gap-2 flex-1"},Te=["type","checked"],Ve={class:"flex items-center gap-2"},Be={key:1,class:"pl-12 space-y-3"},Ne={class:"bg-muted/50 p-4 rounded-lg border"},Pe={class:"whitespace-pre-wrap"},je={key:0,class:"bg-yellow-50 dark:bg-yellow-950 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800"},De={class:"flex items-end gap-3"},Fe={class:"flex-1"},Qe={key:2,class:"pl-12 mt-4"},Re={class:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg border border-blue-200 dark:border-blue-800"},Ge={class:"text-sm text-blue-800 dark:text-blue-200"},Le={key:0,class:"flex justify-end pt-4 border-t"},pt=G({__name:"AttemptDetail",props:{attempt:{},user:{},quiz:{},module:{},course:{},questions:{}},setup(V){const i=V,B=[{title:"Course Online",href:"/admin/course-online"},{title:i.course.name,href:`/admin/course-online/${i.course.id}`},{title:i.quiz.title,href:"#"},{title:"Attempts",href:`/admin/course-online/${i.course.id}/modules/${i.module.id}/quiz/${i.quiz.id}/attempts`},{title:`Attempt #${i.attempt.attempt_number}`,href:"#"}],N=i.quiz.total_points>0?(i.attempt.total_score/i.quiz.total_points*100).toFixed(1):0,A=i.questions.filter(s=>s.type==="text"),g=z({});A.forEach(s=>{s.answer_id&&(g.value[s.answer_id]=s.points_earned)});const P=L(()=>A.length>0),x=O({grades:g.value});function j(){x.put(route("admin.module-quiz.grade-attempt",{courseOnline:i.course.id,courseModule:i.module.id,quiz:i.quiz.id,attempt:i.attempt.id}),{preserveScroll:!0})}function b(s,a){return s.correct_answer.includes(a)}function v(s,a){return s.user_answer?Array.isArray(s.user_answer)?s.user_answer.includes(a):s.user_answer===a:!1}function D(s){return s.user_answer?Array.isArray(s.user_answer)?s.user_answer.join(", "):s.user_answer:"No answer provided"}const w=z(!1);function F(){confirm(`Are you sure you want to reset ALL quiz attempts for ${i.user.name}?

This will:
- Delete all their attempts
- Delete all their answers
- Allow them to retake the quiz from scratch

This action cannot be undone!`)&&(w.value=!0,X.post(route("admin.module-quiz.reset-attempts",{courseOnline:i.course.id,courseModule:i.module.id,quiz:i.quiz.id}),{user_id:i.user.id},{onFinish:()=>{w.value=!1}}))}return(s,a)=>(n(),c(h,null,[l(t(E),{title:`Attempt #${s.attempt.attempt_number} - ${s.user.name}`},null,8,["title"]),l(H,{breadcrumbs:B},{default:d(()=>[e("div",le,[e("div",oe,[e("div",de,[l(t(y),{"as-child":"",variant:"ghost",size:"sm"},{default:d(()=>[l(t(W),{href:s.route("admin.module-quiz.attempts",{courseOnline:s.course.id,courseModule:s.module.id,quiz:s.quiz.id})},{default:d(()=>[l(t(Z),{class:"h-4 w-4 mr-2"}),a[0]||(a[0]=m(" Back to Attempts "))]),_:1},8,["href"])]),_:1}),e("div",null,[a[1]||(a[1]=e("h1",{class:"text-2xl font-bold"},"Quiz Attempt Details",-1)),e("p",ie,o(s.quiz.title),1)])]),l(t(y),{variant:"destructive",onClick:F,disabled:w.value},{default:d(()=>[l(t(q),{class:"h-4 w-4 mr-2"}),m(" "+o(w.value?"Resetting...":"Reset All Attempts"),1)]),_:1},8,["disabled"])]),l(t($),null,{default:d(()=>[l(t(M),null,{default:d(()=>[l(t(U),{class:"flex items-center justify-between"},{default:d(()=>[a[2]||(a[2]=e("span",null,"Attempt Summary",-1)),l(t(f),{variant:s.attempt.passed?"default":"destructive",class:"text-base px-4 py-1"},{default:d(()=>[s.attempt.passed?(n(),p(t(k),{key:0,class:"h-4 w-4 mr-2"})):(n(),p(t(T),{key:1,class:"h-4 w-4 mr-2"})),m(" "+o(s.attempt.passed?"Passed":"Failed"),1)]),_:1},8,["variant"])]),_:1})]),_:1}),l(t(S),{class:"space-y-4"},{default:d(()=>[e("div",ne,[e("div",me,[e("div",ue,[l(t(ee),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[3]||(a[3]=e("p",{class:"text-sm text-muted-foreground"},"Student",-1)),e("p",ce,o(s.user.name),1),e("p",pe,o(s.user.email),1)])]),e("div",fe,[l(t(te),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[4]||(a[4]=e("p",{class:"text-sm text-muted-foreground"},"Attempt Number",-1)),e("p",_e,"#"+o(s.attempt.attempt_number),1)])])]),e("div",ge,[e("div",xe,[l(t(se),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[5]||(a[5]=e("p",{class:"text-sm text-muted-foreground"},"Score",-1)),e("p",be,[m(o(s.attempt.total_score)+" / "+o(s.quiz.total_points)+" ",1),e("span",ve,"("+o(t(N))+"%)",1)]),s.attempt.manual_score?(n(),c("p",we," Auto: "+o(s.attempt.score)+" | Manual: "+o(s.attempt.manual_score),1)):_("",!0)])]),e("div",he,[l(t(re),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[6]||(a[6]=e("p",{class:"text-sm text-muted-foreground"},"Completed",-1)),e("p",ye,o(s.attempt.completed_at||"In Progress"),1)])])])])]),_:1})]),_:1}),l(t($),null,{default:d(()=>[l(t(M),null,{default:d(()=>[l(t(U),null,{default:d(()=>a[7]||(a[7]=[m("Questions & Answers")])),_:1}),l(t(J),null,{default:d(()=>a[8]||(a[8]=[m("Review all questions and user responses")])),_:1})]),_:1}),l(t(S),{class:"space-y-6"},{default:d(()=>[(n(!0),c(h,null,C(s.questions,(r,Q)=>(n(),c("div",{key:r.id,class:"border rounded-lg p-5 space-y-4"},[e("div",ke,[e("div",Ae,[l(t(f),{variant:"outline",class:"mt-1"},{default:d(()=>[m("Q"+o(Q+1),1)]),_:2},1024),e("div",ze,[e("p",Ce,o(r.question_text),1),e("div",$e,[r.type!=="text"?(n(),p(t(f),{key:0,variant:"secondary",class:"text-xs"},{default:d(()=>[m(o(r.points)+" pts ",1)]),_:2},1024)):_("",!0),l(t(f),{variant:"outline",class:"text-xs"},{default:d(()=>[m(o(r.type==="radio"?"Single Choice":r.type==="checkbox"?"Multiple Choice":"Text Answer"),1)]),_:2},1024)])])]),e("div",Se,[r.type!=="text"?(n(),p(t(f),{key:0,variant:r.is_correct?"default":"destructive",class:"text-sm"},{default:d(()=>[r.is_correct?(n(),p(t(k),{key:0,class:"h-3 w-3 mr-1"})):(n(),p(t(T),{key:1,class:"h-3 w-3 mr-1"})),m(" "+o(r.points_earned)+" / "+o(r.points),1)]),_:2},1032,["variant"])):(n(),p(t(f),{key:1,variant:"outline",class:"text-sm"},{default:d(()=>a[9]||(a[9]=[m(" Manual Grading ")])),_:1}))])]),r.type!=="text"?(n(),c("div",Me,[(n(!0),c(h,null,C(r.options,(u,R)=>(n(),c("div",{key:R,class:I(["flex items-center gap-3 p-3 rounded-lg border",{"bg-green-50 dark:bg-green-950 border-green-300 dark:border-green-700":b(r,u),"bg-red-50 dark:bg-red-950 border-red-300 dark:border-red-700":v(r,u)&&!b(r,u),"bg-muted/30":!v(r,u)&&!b(r,u)}])},[e("div",Ue,[e("input",{type:r.type==="radio"?"radio":"checkbox",checked:v(r,u),disabled:"",class:"h-4 w-4"},null,8,Te),e("span",null,o(u),1)]),e("div",Ve,[v(r,u)?(n(),p(t(f),{key:0,variant:"outline",class:"text-xs"},{default:d(()=>a[10]||(a[10]=[m(" User's Answer ")])),_:1})):_("",!0),b(r,u)?(n(),p(t(k),{key:1,class:"h-5 w-5 text-green-600 dark:text-green-400"})):_("",!0)])],2))),128))])):(n(),c("div",Be,[e("div",Ne,[a[11]||(a[11]=e("p",{class:"text-sm text-muted-foreground mb-1"},"User's Answer:",-1)),e("p",Pe,o(D(r)),1)]),r.answer_id?(n(),c("div",je,[e("div",De,[e("div",Fe,[l(t(Y),{for:`grade-${r.answer_id}`,class:"text-sm font-medium text-yellow-900 dark:text-yellow-100"},{default:d(()=>[m(" Assign Points (Max: "+o(r.points)+") ",1)]),_:2},1032,["for"]),l(t(K),{id:`grade-${r.answer_id}`,modelValue:g.value[r.answer_id],"onUpdate:modelValue":u=>g.value[r.answer_id]=u,modelModifiers:{number:!0},type:"number",min:0,max:r.points,class:"mt-1",disabled:t(x).processing},null,8,["id","modelValue","onUpdate:modelValue","max","disabled"])]),l(t(f),{variant:"outline",class:"mb-2"},{default:d(()=>[m(" Current: "+o(r.points_earned)+" pts ",1)]),_:2},1024)])])):_("",!0)])),r.correct_answer_explanation?(n(),c("div",Qe,[e("div",Re,[a[12]||(a[12]=e("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-1"},"Explanation:",-1)),e("p",Ge,o(r.correct_answer_explanation),1)])])):_("",!0)]))),128)),P.value?(n(),c("div",Le,[l(t(y),{onClick:j,disabled:t(x).processing},{default:d(()=>[l(t(ae),{class:"h-4 w-4 mr-2"}),m(" "+o(t(x).processing?"Saving...":"Save Manual Grades"),1)]),_:1},8,["disabled"])])):_("",!0)]),_:1})]),_:1})])]),_:1})],64))}});export{pt as default};
