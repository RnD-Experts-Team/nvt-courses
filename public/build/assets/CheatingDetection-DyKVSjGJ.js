import{d as ke,r as U,c as L,a as u,o as d,b as s,u as t,m as ye,w as l,e as a,g as h,h as S,f as n,t as o,j as we,F as b,i as C,n as $,P as he,W as E}from"./app-De5aCyOy.js";import{S as P,C as ee,_ as Se,a as Ce,b as $e,f as Re}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import{c as Ae,_ as m}from"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import{_ as c}from"./Card.vue_vue_type_script_setup_true_lang-D592-r3Y.js";import{_ as p}from"./CardContent.vue_vue_type_script_setup_true_lang-BnfRKYb9.js";import{_ as T}from"./CardDescription.vue_vue_type_script_setup_true_lang-7y99tksC.js";import{_ as x}from"./CardHeader.vue_vue_type_script_setup_true_lang-B9pSfhlq.js";import{_}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3o6pLjC.js";import{_ as te}from"./index-CNloWqrH.js";import{_ as W}from"./Label.vue_vue_type_script_setup_true_lang-BhPM2rb2.js";import{_ as I,a as N,b as O,c as q,d as v}from"./SelectValue.vue_vue_type_script_setup_true_lang-D84q5NJt.js";import{_ as Ue,a as je,b as se,c as j,d as Me,e as M}from"./TableHeader.vue_vue_type_script_setup_true_lang-CiatGxJJ.js";import{_ as De,a as Ve,b as z,c as B}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-7UCeiX-U.js";import{_ as Te,a as Le}from"./index-Bl7hX8X-.js";import{D as Ee}from"./download-ziV5naxV.js";import{U as G}from"./_plugin-vue_export-helper-DsuA5ZjC.js";import{B as le}from"./book-open-pPANAQ7D.js";import{T as H}from"./triangle-alert-QBZ4KeJk.js";import{T as ze}from"./target-CkYXQ-0W.js";import{C as ae}from"./chart-column-CQTiunbh.js";import{F as Be}from"./filter-Ihqwk31P.js";import{E as J}from"./eye-Jbp-o3OQ.js";import{M as re}from"./mail-CAROg_fB.js";import{A as He}from"./activity-DLqIsvcX.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";import"./clock-BXDw5ZYb.js";import"./useForwardPropsEmits-Cp6q3zLn.js";import"./Presence-DbAr2sRl.js";import"./ConfigProvider-B6_1veax.js";import"./useForwardExpose-Cyi8rQxf.js";import"./Teleport-swefm16Y.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-CPyPlHCY.js";import"./Collection-BDp_B7Ge.js";import"./usePrimitiveElement-B41iOtr7.js";import"./check-DTkWFW74.js";import"./useSize-CHi05SbU.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-9kO_gd9f.js";import"./RovingFocusItem-B6yBawHL.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=Ae("BanIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),Pe={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},We={class:"flex items-start justify-between"},Ie={class:"text-3xl font-bold tracking-tight flex items-center gap-3"},Ne={class:"relative"},Oe={key:0,class:"absolute right-0 mt-2 w-64 bg-popover border rounded-md shadow-lg z-50"},qe={class:"p-2"},Ge={class:"grid gap-4 md:grid-cols-4"},Je={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Ke={class:"text-2xl font-bold text-red-700 dark:text-red-400"},Qe={class:"text-2xl font-bold text-orange-600 dark:text-orange-400"},Xe={class:"text-2xl font-bold text-yellow-600 dark:text-yellow-400"},Ye={class:"grid gap-4 md:grid-cols-4"},Ze={class:"flex items-end gap-2"},et={key:0,class:"text-center py-12"},tt={key:1,class:"space-y-3"},st={class:"flex items-center justify-between"},lt={class:"flex items-center gap-4"},at={class:"font-medium"},rt={class:"text-sm text-muted-foreground"},it={class:"flex items-center gap-4"},nt={class:"text-right"},ot={class:"text-right"},dt={class:"text-sm font-medium"},ut={class:"text-xs text-muted-foreground"},ft={class:"mt-4 pt-4 border-t space-y-4"},mt={key:0,class:"bg-card border rounded-lg p-3"},gt={class:"text-sm space-y-1"},ct={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},pt={class:"text-center p-3 bg-card border rounded"},xt={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},_t={class:"text-center p-3 bg-card border rounded"},vt={class:"text-lg font-bold text-green-600 dark:text-green-400"},bt={class:"text-center p-3 bg-card border rounded"},kt={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},yt={class:"text-center p-3 bg-card border rounded"},wt={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},ht={class:"bg-card border rounded-lg p-3"},St={class:"grid gap-2 md:grid-cols-3 text-sm"},Ct={class:"ml-2 font-medium"},$t={class:"ml-2 font-medium"},Rt={class:"ml-2 font-medium"},At={class:"flex items-center gap-2 pt-2"},Ut={key:2,class:"flex items-center justify-center space-x-2 mt-6"},jt={key:0,class:"text-center py-12"},Mt={key:1,class:"space-y-3"},Dt={class:"font-medium"},Vt={class:"text-sm text-muted-foreground"},Tt={class:"flex items-center gap-4"},Lt={class:"text-right"},Et={class:"text-lg font-bold text-red-600 dark:text-red-400"},zt={class:"flex gap-2"},Bt={class:"grid gap-4 md:grid-cols-2"},Ht={class:"flex items-center justify-between"},Ft={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},Pt={class:"flex items-center justify-between"},Wt={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},It={class:"flex items-center justify-between"},Nt={class:"text-lg font-bold text-red-600 dark:text-red-400"},Ot={class:"flex items-center justify-between"},qt={class:"text-lg font-bold"},Gt={class:"flex items-center justify-between"},Jt={class:"text-lg font-bold text-red-700 dark:text-red-400"},Kt={class:"flex items-center justify-between"},Qt={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},Xt={class:"flex items-center justify-between"},Yt={class:"text-lg font-bold text-yellow-600 dark:text-yellow-400"},Zt={class:"flex items-center justify-between"},es={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Ns=ke({__name:"CheatingDetection",props:{suspiciousSessions:{},cheatingStats:{},filters:{},users:{},courses:{}},setup(ie){const k=ie,ne=[{title:"Report",href:"/admin/reports"},{title:"Cheating Detection",href:"#"}],R=U(k.filters.course_id||"all"),A=U(k.filters.user_id||"all"),D=U(k.filters.min_cheating_score||"50"),V=U(new Set),y=U(!1),f=U(!1),oe=L(()=>k.cheatingStats.total_incidents||0),F=L(()=>k.cheatingStats.high_risk_users||[]),w=L(()=>{const i=k.suspiciousSessions.data||[];return{critical:i.filter(e=>e.cheating_score>=90).length,high:i.filter(e=>e.cheating_score>=70&&e.cheating_score<90).length,medium:i.filter(e=>e.cheating_score>=50&&e.cheating_score<70).length,low:i.filter(e=>e.cheating_score<50).length}});L(()=>[...k.cheatingStats.course_cheating_rates||[]].sort((i,e)=>e.cheating_rate-i.cheating_rate).slice(0,5));const de=()=>{const i=new URLSearchParams;R.value&&R.value!=="all"&&i.append("course_id",R.value),A.value&&A.value!=="all"&&i.append("user_id",A.value),D.value&&i.append("min_cheating_score",D.value),E.get(route("admin.analytics.cheating-detection"),Object.fromEntries(i))},ue=()=>{R.value="all",A.value="all",D.value="50",E.get(route("admin.analytics.cheating-detection"))},fe=i=>{V.value.has(i)?V.value.delete(i):V.value.add(i)},me=async()=>{if(!f.value)try{f.value=!0,window.open(route("admin.analytics.export",{type:"high_risk_users"}),"_blank"),y.value=!1}catch(i){console.error("Export failed:",i),alert("Export failed. Please try again.")}finally{f.value=!1}},ge=async()=>{if(!f.value)try{f.value=!0,window.open(route("admin.analytics.export",{type:"course_security"}),"_blank"),y.value=!1}catch(i){console.error("Export failed:",i),alert("Export failed. Please try again.")}finally{f.value=!1}},ce=i=>{switch(i.toLowerCase()){case"critical":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800";case"high":return"bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800";case"low":return"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-900/20 dark:text-gray-400 dark:border-gray-800"}},K=i=>i>=90?"text-red-700 dark:text-red-400":i>=70?"text-orange-700 dark:text-orange-400":i>=50?"text-yellow-700 dark:text-yellow-400":"text-blue-700 dark:text-blue-400",pe=i=>i>=90?"border-red-300 bg-red-50 dark:border-red-800 dark:bg-red-950/20":i>=70?"border-orange-300 bg-orange-50 dark:border-orange-800 dark:bg-orange-950/20":i>=50?"border-yellow-300 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-950/20":"border-blue-300 bg-blue-50 dark:border-blue-800 dark:bg-blue-950/20",Q=i=>i>=90?"Critical":i>=70?"High":i>=50?"Medium":"Low",xe=i=>{if(i<60)return`${Math.round(i)}m`;const e=Math.floor(i/60),r=Math.round(i%60);return`${e}h ${r}m`},X=async i=>{if(!f.value)try{f.value=!0,E.post(route("admin.analytics.send-warning",i),{session_data:{course_name:"Current Course",risk_score:75,risk_level:"Medium",session_date:new Date().toLocaleDateString(),duration:"30 minutes",reasons:["Unusual learning pattern detected"]}},{onSuccess:e=>{alert("âœ… Warning email sent successfully!")},onError:e=>{console.error("Warning email errors:",e),alert("âŒ Failed to send warning email: "+(e.message||"Unknown error"))},onFinish:()=>{f.value=!1}})}catch(e){console.error("Warning email failed:",e),alert("âŒ Failed to send warning email. Please try again."),f.value=!1}},_e=i=>{confirm("Are you sure you want to suspend this user?")&&alert(`User ${i} suspended`)},ve=i=>new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),be=()=>{y.value=!1};return(i,e)=>(d(),u(b,null,[s(t(ye),{title:"Cheating Detection"}),s(Re,{breadcrumbs:ne},{default:l(()=>[a("div",Pe,[a("div",We,[a("div",null,[a("h1",Ie,[s(t(P),{class:"h-8 w-8 text-red-600 dark:text-red-400"}),e[4]||(e[4]=n(" Cheating Detection & Prevention "))]),e[5]||(e[5]=a("p",{class:"text-muted-foreground mt-1"},"Monitor and investigate suspicious learning activities",-1))]),a("div",Ne,[s(t(m),{variant:"outline",size:"sm",onClick:e[0]||(e[0]=r=>y.value=!y.value),disabled:f.value},{default:l(()=>[s(t(Ee),{class:"mr-2 h-4 w-4"}),n(" "+o(f.value?"Exporting...":"Export Reports")+" ",1),s(t(ee),{class:"ml-2 h-4 w-4"})]),_:1},8,["disabled"]),y.value?(d(),u("div",Oe,[a("div",qe,[e[8]||(e[8]=a("div",{class:"text-sm font-medium text-muted-foreground mb-2"},"Choose Report Type:",-1)),s(t(m),{variant:"ghost",size:"sm",class:"w-full justify-start mb-1",onClick:me,disabled:f.value},{default:l(()=>[s(t(G),{class:"mr-2 h-4 w-4 text-orange-500"}),e[6]||(e[6]=n(" High Risk Users Report "))]),_:1},8,["disabled"]),s(t(m),{variant:"ghost",size:"sm",class:"w-full justify-start",onClick:ge,disabled:f.value},{default:l(()=>[s(t(le),{class:"mr-2 h-4 w-4 text-blue-500"}),e[7]||(e[7]=n(" Course Security Report "))]),_:1},8,["disabled"])])])):S("",!0),y.value?(d(),u("div",{key:1,class:"fixed inset-0 z-40",onClick:be})):S("",!0)])]),a("div",Ge,[s(t(c),null,{default:l(()=>[s(t(x),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(_),{class:"text-sm font-medium"},{default:l(()=>e[9]||(e[9]=[n("Total Incidents")])),_:1}),s(t(H),{class:"h-4 w-4 text-red-600 dark:text-red-400"})]),_:1}),s(t(p),null,{default:l(()=>[a("div",Je,o(oe.value),1),e[10]||(e[10]=a("p",{class:"text-xs text-muted-foreground"},"Suspicious activities detected",-1))]),_:1})]),_:1}),s(t(c),null,{default:l(()=>[s(t(x),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(_),{class:"text-sm font-medium"},{default:l(()=>e[11]||(e[11]=[n("Critical Risk")])),_:1}),s(t(ze),{class:"h-4 w-4 text-red-700 dark:text-red-400"})]),_:1}),s(t(p),null,{default:l(()=>[a("div",Ke,o(w.value.critical),1),e[12]||(e[12]=a("p",{class:"text-xs text-muted-foreground"},"Score â‰¥ 90",-1))]),_:1})]),_:1}),s(t(c),null,{default:l(()=>[s(t(x),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(_),{class:"text-sm font-medium"},{default:l(()=>e[13]||(e[13]=[n("High Risk Users")])),_:1}),s(t(G),{class:"h-4 w-4 text-orange-600 dark:text-orange-400"})]),_:1}),s(t(p),null,{default:l(()=>[a("div",Qe,o(F.value.length),1),e[14]||(e[14]=a("p",{class:"text-xs text-muted-foreground"},"Repeat offenders",-1))]),_:1})]),_:1}),s(t(c),null,{default:l(()=>[s(t(x),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(_),{class:"text-sm font-medium"},{default:l(()=>e[15]||(e[15]=[n("Avg Risk Score")])),_:1}),s(t(ae),{class:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})]),_:1}),s(t(p),null,{default:l(()=>{var r;return[a("div",Xe,o(Math.round(i.cheatingStats.average_cheating_score||((r=i.cheatingStats.cheating_patterns)==null?void 0:r.avg_cheating_score)||0)),1),e[16]||(e[16]=a("p",{class:"text-xs text-muted-foreground"},"Across all incidents",-1))]}),_:1})]),_:1})]),w.value.critical>0?(d(),h(t(Te),{key:0,class:"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950/20"},{default:l(()=>[s(t(H),{class:"h-4 w-4 text-red-600 dark:text-red-400"}),s(t(Le),{class:"text-red-800 dark:text-red-200"},{default:l(()=>[a("strong",null,o(w.value.critical),1),e[17]||(e[17]=n(" critical risk sessions require immediate attention. These sessions show extremely suspicious patterns and should be investigated immediately. "))]),_:1})]),_:1})):S("",!0),s(t(c),null,{default:l(()=>[s(t(x),null,{default:l(()=>[s(t(_),{class:"flex items-center gap-2"},{default:l(()=>[s(t(Be),{class:"h-5 w-5"}),e[18]||(e[18]=n(" Investigation Filters "))]),_:1})]),_:1}),s(t(p),null,{default:l(()=>[a("form",{onSubmit:we(de,["prevent"]),class:"space-y-4"},[a("div",Ye,[a("div",null,[s(t(W),{for:"course"},{default:l(()=>e[19]||(e[19]=[n("Course")])),_:1}),s(t(I),{modelValue:R.value,"onUpdate:modelValue":e[1]||(e[1]=r=>R.value=r)},{default:l(()=>[s(t(N),null,{default:l(()=>[s(t(O),{placeholder:"All Courses"})]),_:1}),s(t(q),null,{default:l(()=>[s(t(v),{value:"all"},{default:l(()=>e[20]||(e[20]=[n("All Courses")])),_:1}),(d(!0),u(b,null,C(i.courses,r=>(d(),h(t(v),{key:r.id,value:r.id.toString()},{default:l(()=>[n(o(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[s(t(W),{for:"user"},{default:l(()=>e[21]||(e[21]=[n("User")])),_:1}),s(t(I),{modelValue:A.value,"onUpdate:modelValue":e[2]||(e[2]=r=>A.value=r)},{default:l(()=>[s(t(N),null,{default:l(()=>[s(t(O),{placeholder:"All Users"})]),_:1}),s(t(q),null,{default:l(()=>[s(t(v),{value:"all"},{default:l(()=>e[22]||(e[22]=[n("All Users")])),_:1}),(d(!0),u(b,null,C(i.users,r=>(d(),h(t(v),{key:r.id,value:r.id.toString()},{default:l(()=>[n(o(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[s(t(W),{for:"score"},{default:l(()=>e[23]||(e[23]=[n("Min Risk Score")])),_:1}),s(t(I),{modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=r=>D.value=r)},{default:l(()=>[s(t(N),null,{default:l(()=>[s(t(O))]),_:1}),s(t(q),null,{default:l(()=>[s(t(v),{value:"90"},{default:l(()=>e[24]||(e[24]=[n("Critical (90+)")])),_:1}),s(t(v),{value:"70"},{default:l(()=>e[25]||(e[25]=[n("High (70+)")])),_:1}),s(t(v),{value:"50"},{default:l(()=>e[26]||(e[26]=[n("Medium (50+)")])),_:1}),s(t(v),{value:"30"},{default:l(()=>e[27]||(e[27]=[n("Low (30+)")])),_:1}),s(t(v),{value:"0"},{default:l(()=>e[28]||(e[28]=[n("All Incidents")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),a("div",Ze,[s(t(m),{type:"submit",class:"flex-1"},{default:l(()=>e[29]||(e[29]=[n("Apply")])),_:1}),s(t(m),{type:"button",variant:"outline",onClick:ue},{default:l(()=>e[30]||(e[30]=[n("Clear")])),_:1})])])],32)]),_:1})]),_:1}),s(t(De),{"default-value":"incidents",class:"space-y-4"},{default:l(()=>[s(t(Ve),null,{default:l(()=>[s(t(z),{value:"incidents"},{default:l(()=>e[31]||(e[31]=[n("Suspicious Incidents")])),_:1}),s(t(z),{value:"users"},{default:l(()=>e[32]||(e[32]=[n("High Risk Users")])),_:1}),s(t(z),{value:"patterns"},{default:l(()=>e[33]||(e[33]=[n("Cheating Patterns")])),_:1}),s(t(z),{value:"courses"},{default:l(()=>e[34]||(e[34]=[n("Course Risk Analysis")])),_:1})]),_:1}),s(t(B),{value:"incidents",class:"space-y-4"},{default:l(()=>[s(t(c),null,{default:l(()=>[s(t(x),null,{default:l(()=>[s(t(_),{class:"flex items-center gap-2"},{default:l(()=>[s(t(H),{class:"h-5 w-5 text-red-600 dark:text-red-400"}),e[35]||(e[35]=n(" Suspicious Learning Sessions "))]),_:1}),s(t(T),null,{default:l(()=>{var r;return[n(" Showing "+o(((r=i.suspiciousSessions.data)==null?void 0:r.length)||0)+" suspicious sessions "+o(i.suspiciousSessions.total?`of ${i.suspiciousSessions.total} total`:""),1)]}),_:1})]),_:1}),s(t(p),null,{default:l(()=>[!i.suspiciousSessions.data||i.suspiciousSessions.data.length===0?(d(),u("div",et,[s(t(P),{class:"h-16 w-16 mx-auto mb-4 text-green-600 dark:text-green-400"}),e[36]||(e[36]=a("h3",{class:"text-lg font-medium mb-2"},"No Suspicious Activities",-1)),e[37]||(e[37]=a("p",{class:"text-muted-foreground"},"All learning sessions appear normal",-1))])):(d(),u("div",tt,[(d(!0),u(b,null,C(i.suspiciousSessions.data,r=>(d(),u("div",{key:r.id,class:$(["border rounded-lg p-4",pe(r.cheating_score)])},[s(t(Se),null,{default:l(()=>[s(t(Ce),{onClick:g=>fe(r.id),class:"w-full text-left"},{default:l(()=>[a("div",st,[a("div",lt,[s(t(te),{class:$(ce(Q(r.cheating_score)))},{default:l(()=>[n(o(Q(r.cheating_score)),1)]),_:2},1032,["class"]),a("div",null,[a("div",at,o(r.user.name),1),a("div",rt,o(r.course)+" â€¢ "+o(r.content_title),1)])]),a("div",it,[a("div",nt,[a("div",{class:$(["text-lg font-bold",K(r.cheating_score)])},o(r.cheating_score),3),e[38]||(e[38]=a("div",{class:"text-xs text-muted-foreground"},"Risk Score",-1))]),a("div",ot,[a("div",dt,o(ve(r.session_start)),1),a("div",ut,o(r.duration),1)]),s(t(ee),{class:$(["h-4 w-4 transition-transform",{"rotate-180":V.value.has(r.id)}])},null,8,["class"])])])]),_:2},1032,["onClick"]),V.value.has(r.id)?(d(),h(t($e),{key:0},{default:l(()=>[a("div",ft,[r.cheating_reasons&&r.cheating_reasons.length>0?(d(),u("div",mt,[e[39]||(e[39]=a("h4",{class:"font-medium mb-2 text-red-700 dark:text-red-400"},"ðŸš¨ Suspicious Indicators:",-1)),a("ul",gt,[(d(!0),u(b,null,C(r.cheating_reasons,g=>(d(),u("li",{key:g,class:"flex items-center gap-2"},[s(t(H),{class:"h-3 w-3 text-red-500"}),n(" "+o(g),1)]))),128))])])):S("",!0),a("div",ct,[a("div",pt,[a("div",xt,o(r.attention_score)+"%",1),e[40]||(e[40]=a("div",{class:"text-xs text-muted-foreground"},"Attention Score",-1))]),a("div",_t,[a("div",vt,o(r.video_completion)+"%",1),e[41]||(e[41]=a("div",{class:"text-xs text-muted-foreground"},"Video Completion",-1))]),a("div",bt,[a("div",kt,o(r.skip_count),1),e[42]||(e[42]=a("div",{class:"text-xs text-muted-foreground"},"Skip Count",-1))]),a("div",yt,[a("div",wt,o(r.seek_count),1),e[43]||(e[43]=a("div",{class:"text-xs text-muted-foreground"},"Seek Count",-1))])]),a("div",ht,[e[47]||(e[47]=a("h4",{class:"font-medium mb-2"},"Video Behavior Analysis",-1)),a("div",St,[a("div",null,[e[44]||(e[44]=a("span",{class:"text-muted-foreground"},"Watch Time:",-1)),a("span",Ct,o(xe(r.video_watch_time)),1)]),a("div",null,[e[45]||(e[45]=a("span",{class:"text-muted-foreground"},"Total Duration:",-1)),a("span",$t,o(r.duration),1)]),a("div",null,[e[46]||(e[46]=a("span",{class:"text-muted-foreground"},"Completion:",-1)),a("span",Rt,o(r.video_completion)+"%",1)])])]),a("div",At,[s(t(m),{size:"sm",variant:"outline",asChild:""},{default:l(()=>[s(t(he),{href:i.route("admin.analytics.session-details",r.id)},{default:l(()=>[s(t(J),{class:"mr-2 h-4 w-4"}),e[48]||(e[48]=n(" View Details "))]),_:2},1032,["href"])]),_:2},1024),s(t(m),{size:"sm",variant:"outline",onClick:g=>X(r.user.id)},{default:l(()=>[s(t(re),{class:"mr-2 h-4 w-4"}),e[49]||(e[49]=n(" Send Warning "))]),_:2},1032,["onClick"]),r.cheating_score>=90?(d(),h(t(m),{key:0,size:"sm",variant:"destructive",onClick:g=>_e(r.user.id)},{default:l(()=>[s(t(Fe),{class:"mr-2 h-4 w-4"}),e[50]||(e[50]=n(" Suspend User "))]),_:2},1032,["onClick"])):S("",!0)])])]),_:2},1024)):S("",!0)]),_:2},1024)],2))),128))])),i.suspiciousSessions.links&&i.suspiciousSessions.links.length>0?(d(),u("div",Ut,[(d(!0),u(b,null,C(i.suspiciousSessions.links,r=>(d(),h(t(m),{key:r.label,variant:r.active?"default":"outline",disabled:!r.url,size:"sm",onClick:g=>r.url&&t(E).get(r.url),innerHTML:r.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])):S("",!0)]),_:1})]),_:1})]),_:1}),s(t(B),{value:"users",class:"space-y-4"},{default:l(()=>[s(t(c),null,{default:l(()=>[s(t(x),null,{default:l(()=>[s(t(_),{class:"flex items-center gap-2"},{default:l(()=>[s(t(G),{class:"h-5 w-5 text-red-600 dark:text-red-400"}),e[51]||(e[51]=n(" High Risk Users "))]),_:1}),s(t(T),null,{default:l(()=>e[52]||(e[52]=[n("Users with multiple suspicious activities")])),_:1})]),_:1}),s(t(p),null,{default:l(()=>[F.value.length===0?(d(),u("div",jt,[s(t(P),{class:"h-16 w-16 mx-auto mb-4 text-green-600 dark:text-green-400"}),e[53]||(e[53]=a("h3",{class:"text-lg font-medium mb-2"},"No High Risk Users",-1)),e[54]||(e[54]=a("p",{class:"text-muted-foreground"},"All users are showing normal learning behavior",-1))])):(d(),u("div",Mt,[(d(!0),u(b,null,C(F.value,r=>(d(),u("div",{key:r.id,class:"flex items-center justify-between p-4 border border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950/20 rounded-lg"},[a("div",null,[a("div",Dt,o(r.name),1),a("div",Vt,o(r.email),1)]),a("div",Tt,[a("div",Lt,[a("div",Et,o(r.suspicious_sessions_count),1),e[55]||(e[55]=a("div",{class:"text-xs text-muted-foreground"},"Suspicious Sessions",-1))]),a("div",zt,[s(t(m),{size:"sm",variant:"outline"},{default:l(()=>[s(t(J),{class:"mr-2 h-4 w-4"}),e[56]||(e[56]=n(" View Details "))]),_:1}),s(t(m),{size:"sm",variant:"outline",onClick:g=>X(r.id)},{default:l(()=>[s(t(re),{class:"mr-2 h-4 w-4"}),e[57]||(e[57]=n(" Send Warning "))]),_:2},1032,["onClick"])])])]))),128))]))]),_:1})]),_:1})]),_:1}),s(t(B),{value:"patterns",class:"space-y-4"},{default:l(()=>[a("div",Bt,[s(t(c),null,{default:l(()=>[s(t(x),null,{default:l(()=>[s(t(_),{class:"flex items-center gap-2"},{default:l(()=>[s(t(He),{class:"h-5 w-5 text-purple-600 dark:text-purple-400"}),e[58]||(e[58]=n(" Common Cheating Patterns "))]),_:1}),s(t(T),null,{default:l(()=>e[59]||(e[59]=[n("Average behavior in suspicious sessions")])),_:1})]),_:1}),s(t(p),{class:"space-y-4"},{default:l(()=>{var r,g,Y,Z;return[a("div",Ht,[e[60]||(e[60]=a("span",null,"Average Skips per Session",-1)),a("div",Ft,o(Math.round(((r=i.cheatingStats.cheating_patterns)==null?void 0:r.avg_skips)||0)),1)]),a("div",Pt,[e[61]||(e[61]=a("span",null,"Average Seeks per Session",-1)),a("div",Wt,o(Math.round(((g=i.cheatingStats.cheating_patterns)==null?void 0:g.avg_seeks)||0)),1)]),a("div",It,[e[62]||(e[62]=a("span",null,"Average Cheating Score",-1)),a("div",Nt,o(Math.round(((Y=i.cheatingStats.cheating_patterns)==null?void 0:Y.avg_cheating_score)||0)),1)]),a("div",Ot,[e[63]||(e[63]=a("span",null,"Total Incidents",-1)),a("div",qt,o(((Z=i.cheatingStats.cheating_patterns)==null?void 0:Z.total_incidents)||0),1)])]}),_:1})]),_:1}),s(t(c),null,{default:l(()=>[s(t(x),null,{default:l(()=>[s(t(_),{class:"flex items-center gap-2"},{default:l(()=>[s(t(ae),{class:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e[64]||(e[64]=n(" Risk Level Distribution "))]),_:1}),s(t(T),null,{default:l(()=>e[65]||(e[65]=[n("Breakdown by severity")])),_:1})]),_:1}),s(t(p),{class:"space-y-4"},{default:l(()=>[a("div",Gt,[e[66]||(e[66]=a("div",{class:"flex items-center gap-2"},[a("div",{class:"w-3 h-3 bg-red-700 dark:bg-red-400 rounded"}),a("span",null,"Critical (90+)")],-1)),a("div",Jt,o(w.value.critical),1)]),a("div",Kt,[e[67]||(e[67]=a("div",{class:"flex items-center gap-2"},[a("div",{class:"w-3 h-3 bg-orange-600 dark:bg-orange-400 rounded"}),a("span",null,"High (70-89)")],-1)),a("div",Qt,o(w.value.high),1)]),a("div",Xt,[e[68]||(e[68]=a("div",{class:"flex items-center gap-2"},[a("div",{class:"w-3 h-3 bg-yellow-600 dark:bg-yellow-400 rounded"}),a("span",null,"Medium (50-69)")],-1)),a("div",Yt,o(w.value.medium),1)]),a("div",Zt,[e[69]||(e[69]=a("div",{class:"flex items-center gap-2"},[a("div",{class:"w-3 h-3 bg-blue-600 dark:bg-blue-400 rounded"}),a("span",null,"Low (30-49)")],-1)),a("div",es,o(w.value.low),1)])]),_:1})]),_:1})])]),_:1}),s(t(B),{value:"courses",class:"space-y-4"},{default:l(()=>[s(t(c),null,{default:l(()=>[s(t(x),null,{default:l(()=>[s(t(_),{class:"flex items-center gap-2"},{default:l(()=>[s(t(le),{class:"h-5 w-5 text-orange-600 dark:text-orange-400"}),e[70]||(e[70]=n(" Course Risk Analysis "))]),_:1}),s(t(T),null,{default:l(()=>e[71]||(e[71]=[n("Cheating rates by course")])),_:1})]),_:1}),s(t(p),null,{default:l(()=>[s(t(Ue),null,{default:l(()=>[s(t(je),null,{default:l(()=>[s(t(se),null,{default:l(()=>[s(t(j),null,{default:l(()=>e[72]||(e[72]=[n("Course Name")])),_:1}),s(t(j),null,{default:l(()=>e[73]||(e[73]=[n("Total Sessions")])),_:1}),s(t(j),null,{default:l(()=>e[74]||(e[74]=[n("Suspicious Sessions")])),_:1}),s(t(j),null,{default:l(()=>e[75]||(e[75]=[n("Cheating Rate")])),_:1}),s(t(j),null,{default:l(()=>e[76]||(e[76]=[n("Risk Level")])),_:1}),s(t(j),null,{default:l(()=>e[77]||(e[77]=[n("Actions")])),_:1})]),_:1})]),_:1}),s(t(Me),null,{default:l(()=>[(d(!0),u(b,null,C(i.cheatingStats.course_cheating_rates,r=>(d(),h(t(se),{key:r.name},{default:l(()=>[s(t(M),{class:"font-medium"},{default:l(()=>[n(o(r.name),1)]),_:2},1024),s(t(M),null,{default:l(()=>[n(o(r.total_sessions),1)]),_:2},1024),s(t(M),null,{default:l(()=>[a("span",{class:$(r.suspicious_sessions>0?"text-red-600 dark:text-red-400 font-medium":"")},o(r.suspicious_sessions),3)]),_:2},1024),s(t(M),null,{default:l(()=>[a("span",{class:$([K(r.cheating_rate),"font-medium"])},o(r.cheating_rate)+"% ",3)]),_:2},1024),s(t(M),null,{default:l(()=>[s(t(te),{class:$(r.cheating_rate>=20?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":r.cheating_rate>=10?"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400":r.cheating_rate>0?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400")},{default:l(()=>[n(o(r.cheating_rate>=20?"High Risk":r.cheating_rate>=10?"Medium Risk":r.cheating_rate>0?"Low Risk":"Safe"),1)]),_:2},1032,["class"])]),_:2},1024),s(t(M),null,{default:l(()=>[s(t(m),{variant:"outline",size:"sm"},{default:l(()=>[s(t(J),{class:"mr-2 h-4 w-4"}),e[78]||(e[78]=n(" Investigate "))]),_:1})]),_:1})]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})],64))}});export{Ns as default};
