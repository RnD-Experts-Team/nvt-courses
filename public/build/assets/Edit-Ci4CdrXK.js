import{d as le,C as ie,r as y,c as ae,a as m,o as d,b as s,u as t,m as re,w as o,e as i,P as W,f as r,t as p,j as ue,h as c,n as $,s as ne,F as q,i as de,v as me,g as fe,x as ve}from"./app-De5aCyOy.js";import{V as pe,f as ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-DrTEAkGA.js";import{_ as n}from"./Button.vue_vue_type_script_setup_true_lang-C1ptny9S.js";import{_ as V}from"./Card.vue_vue_type_script_setup_true_lang-D592-r3Y.js";import{_ as R}from"./CardContent.vue_vue_type_script_setup_true_lang-BnfRKYb9.js";import{_ as M}from"./CardDescription.vue_vue_type_script_setup_true_lang-7y99tksC.js";import{_ as z}from"./CardHeader.vue_vue_type_script_setup_true_lang-B9pSfhlq.js";import{_ as L}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3o6pLjC.js";import{_ as U}from"./Input.vue_vue_type_script_setup_true_lang-XEyr05A5.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-BhPM2rb2.js";import{_ as ge}from"./Textarea.vue_vue_type_script_setup_true_lang-B6XbqApa.js";import{_ as be}from"./Switch.vue_vue_type_script_setup_true_lang-Cp6QCENU.js";import{_ as H,a as O}from"./index-Bl7hX8X-.js";import{A as _e}from"./arrow-left-kG5YrchA.js";import{L as xe}from"./link-ItMdrcrR.js";import{C as he}from"./clock-BXDw5ZYb.js";import{X as E}from"./_plugin-vue_export-helper-DsuA5ZjC.js";import{I as ye}from"./image-BeZKZ5ia.js";import{U as F}from"./upload-BM6JiC8r.js";import{T as J}from"./trash-2-cH28u5cA.js";import{T as we}from"./tag-b4i1_NNu.js";import{T as ke}from"./triangle-alert-QBZ4KeJk.js";import{S as Ce}from"./save-Cj1WR6gV.js";import"./index-D3npKzxP.js";import"./index-shR_F4Lk.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-UOeKMcHs.js";import"./useForwardPropsEmits-Cp6q3zLn.js";import"./useForwardExpose-Cyi8rQxf.js";import"./VisuallyHidden-9kO_gd9f.js";import"./VisuallyHiddenInput-CPW02NT0.js";import"./usePrimitiveElement-B41iOtr7.js";const $e={class:"max-w-2xl mx-auto space-y-6"},Ue={class:"flex items-center gap-4"},Se={class:"text-muted-foreground"},Ie={class:"space-y-2"},Te={key:0,class:"text-sm text-destructive"},De={class:"space-y-2"},Ve={key:0,class:"text-sm text-destructive"},Re={class:"space-y-2"},Me=["value","selected"],ze={key:0,class:"text-sm text-destructive"},Le={class:"space-y-2"},Fe={key:0,class:"text-sm text-destructive"},Ae={class:"space-y-3"},Ne={class:"grid grid-cols-3 gap-3"},Ee={class:"space-y-2"},Pe={class:"space-y-2"},je={class:"space-y-2"},Be={class:"flex items-center justify-between p-3 rounded-lg bg-muted/50 border"},Ge={class:"flex items-center gap-2"},We={class:"text-sm text-muted-foreground"},qe={class:"space-y-2"},He={class:"flex flex-wrap gap-2"},Oe={key:0,class:"text-sm text-destructive"},Je={key:0,class:"space-y-3"},Ke={class:"relative w-48 h-32 rounded-lg overflow-hidden border"},Qe=["src"],Xe={class:"flex gap-2"},Ye={key:1,class:"space-y-3"},Ze={class:"flex gap-2"},et={class:"space-y-3"},tt={key:1,class:"space-y-3"},st={class:"relative w-48 h-32 rounded-lg overflow-hidden border"},ot=["src"],lt={class:"flex gap-2"},it={key:2,class:"text-sm text-destructive"},at={class:"space-y-2"},rt={key:0,class:"text-sm text-destructive"},ut={class:"text-sm text-muted-foreground"},nt={class:"flex items-center justify-between"},dt={class:"space-y-1"},mt={class:"flex justify-between items-center"},Wt=le({__name:"Edit",props:{audio:{},categories:{}},setup(K){var B;const v=K,Q=[{title:"Audio Management",href:"/admin/audio"},{title:v.audio.name,href:`/admin/audio/${v.audio.id}`},{title:"Edit",href:"#"}],A=(u=>{if(!u)return{hours:0,minutes:0,seconds:0};const e=Math.floor(u/3600),l=Math.floor(u%3600/60),C=u%60;return{hours:e,minutes:l,seconds:C}})(v.audio.duration),a=ie({name:v.audio.name||"",description:v.audio.description||"",google_cloud_url:v.audio.google_cloud_url||"",duration:"",thumbnail:null,thumbnail_url:v.audio.thumbnail_url||"",remove_thumbnail:!1,audio_category_id:((B=v.audio.audio_category_id)==null?void 0:B.toString())||"",is_active:v.audio.is_active??!0}),S=y(!1),h=y(null),w=y(null),g=y(!1),P=v.audio.thumbnail_url||v.audio.thumbnail_path,b=y(A.hours),_=y(A.minutes),x=y(A.seconds),I=()=>{const u=b.value.toString().padStart(2,"0"),e=_.value.toString().padStart(2,"0"),l=x.value.toString().padStart(2,"0");b.value>0||_.value>0||x.value>0?a.duration=`${u}:${e}:${l}`:a.duration=""},N=(u,e)=>{let l=parseInt(e)||0;u==="hours"?(l=Math.max(0,Math.min(99,l)),b.value=l):u==="minutes"?(l=Math.max(0,Math.min(59,l)),_.value=l):u==="seconds"&&(l=Math.max(0,Math.min(59,l)),x.value=l),I()},k=(u,e,l)=>{b.value=u,_.value=e,x.value=l,I()},X=()=>{b.value=0,_.value=0,x.value=0,I()},Y=ae(()=>{const u=[];return b.value>0&&u.push(`${b.value}h`),_.value>0&&u.push(`${_.value}m`),x.value>0&&u.push(`${x.value}s`),u.length>0?u.join(" "):"Not set"}),Z=u=>{if(!u)return 0;const e=u.split(":");if(e.length===3){const l=parseInt(e[0])||0,C=parseInt(e[1])||0,D=parseInt(e[2])||0;return l*3600+C*60+D}return 0};I();function ee(u){var C;const e=u.target,l=(C=e.files)==null?void 0:C[0];if(l){if(l.size>2*1024*1024){alert("File size must be less than 2MB"),e.value="";return}if(!l.type.startsWith("image/")){alert("Please select an image file"),e.value="";return}a.thumbnail=l;const D=new FileReader;D.onload=oe=>{var G;h.value=(G=oe.target)==null?void 0:G.result},D.readAsDataURL(l),a.thumbnail_url="",a.remove_thumbnail=!1,g.value=!1}}function te(){a.thumbnail=null,h.value=null,w.value&&(w.value.value="")}function T(){var u;(u=w.value)==null||u.click()}function j(){g.value=!g.value,a.remove_thumbnail=g.value,g.value&&(a.thumbnail=null,h.value=null,w.value&&(w.value.value=""))}const se=async()=>{S.value=!0;let u=null;a.duration&&(u=Z(a.duration)),await ve(),a.transform(e=>({...e,_method:"PUT",duration:u,audio_category_id:e.audio_category_id||null})).post(`/admin/audio/${v.audio.id}`,{forceFormData:!0,onFinish:()=>{S.value=!1}})};return(u,e)=>(d(),m(q,null,[s(t(re),{title:`Edit ${u.audio.name}`},null,8,["title"]),s(ce,{breadcrumbs:Q},{default:o(()=>[i("div",$e,[i("div",Ue,[s(t(n),{asChild:"",variant:"ghost"},{default:o(()=>[s(t(W),{href:`/admin/audio/${u.audio.id}`},{default:o(()=>[s(t(_e),{class:"h-4 w-4 mr-2"}),e[15]||(e[15]=r(" Back to Audio "))]),_:1},8,["href"])]),_:1}),i("div",null,[e[16]||(e[16]=i("h1",{class:"text-2xl font-bold"},"Edit Audio Course",-1)),i("p",Se,'Update the details for "'+p(u.audio.name)+'"',1)])]),i("form",{onSubmit:ue(se,["prevent"]),class:"space-y-6",enctype:"multipart/form-data"},[s(t(V),null,{default:o(()=>[s(t(z),null,{default:o(()=>[s(t(L),{class:"flex items-center gap-2"},{default:o(()=>[s(t(pe),{class:"h-5 w-5"}),e[17]||(e[17]=r(" Basic Information "))]),_:1}),s(t(M),null,{default:o(()=>e[18]||(e[18]=[r(" Update the basic details for your audio course ")])),_:1})]),_:1}),s(t(R),{class:"space-y-4"},{default:o(()=>[i("div",Ie,[s(t(f),{for:"name"},{default:o(()=>e[19]||(e[19]=[r("Course Name *")])),_:1}),s(t(U),{id:"name",modelValue:t(a).name,"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).name=l),type:"text",placeholder:"Enter audio course name",class:$({"border-destructive":t(a).errors.name}),required:""},null,8,["modelValue","class"]),t(a).errors.name?(d(),m("div",Te,p(t(a).errors.name),1)):c("",!0)]),i("div",De,[s(t(f),{for:"description"},{default:o(()=>e[20]||(e[20]=[r("Description")])),_:1}),s(t(ge),{id:"description",modelValue:t(a).description,"onUpdate:modelValue":e[1]||(e[1]=l=>t(a).description=l),placeholder:"Describe what this audio course covers...",rows:4,class:$({"border-destructive":t(a).errors.description})},null,8,["modelValue","class"]),t(a).errors.description?(d(),m("div",Ve,p(t(a).errors.description),1)):c("",!0)]),i("div",Re,[s(t(f),{for:"category"},{default:o(()=>e[21]||(e[21]=[r("Category")])),_:1}),ne(i("select",{id:"category","onUpdate:modelValue":e[2]||(e[2]=l=>t(a).audio_category_id=l),class:$(["flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":t(a).errors.audio_category_id}])},[e[22]||(e[22]=i("option",{value:""},"No Category",-1)),(d(!0),m(q,null,de(u.categories,l=>(d(),m("option",{key:l.id,value:l.id.toString(),selected:l.id.toString()===t(a).audio_category_id},p(l.name),9,Me))),128))],2),[[me,t(a).audio_category_id]]),t(a).errors.audio_category_id?(d(),m("div",ze,p(t(a).errors.audio_category_id),1)):c("",!0)])]),_:1})]),_:1}),s(t(V),null,{default:o(()=>[s(t(z),null,{default:o(()=>[s(t(L),{class:"flex items-center gap-2"},{default:o(()=>[s(t(xe),{class:"h-5 w-5"}),e[23]||(e[23]=r(" Media Information "))]),_:1}),s(t(M),null,{default:o(()=>e[24]||(e[24]=[r(" Update the Google Drive/Cloud Storage URL and media details ")])),_:1})]),_:1}),s(t(R),{class:"space-y-4"},{default:o(()=>[i("div",Le,[s(t(f),{for:"google_cloud_url"},{default:o(()=>e[25]||(e[25]=[r("Google Drive/Cloud URL *")])),_:1}),s(t(U),{id:"google_cloud_url",modelValue:t(a).google_cloud_url,"onUpdate:modelValue":e[3]||(e[3]=l=>t(a).google_cloud_url=l),type:"url",placeholder:"https://drive.google.com/file/d/YOUR_FILE_ID/view",class:$({"border-destructive":t(a).errors.google_cloud_url}),required:""},null,8,["modelValue","class"]),t(a).errors.google_cloud_url?(d(),m("div",Fe,p(t(a).errors.google_cloud_url),1)):c("",!0),e[26]||(e[26]=i("div",{class:"text-sm text-muted-foreground"}," Enter the Google Drive sharing URL or Google Cloud Storage URL ",-1))]),i("div",Ae,[s(t(f),null,{default:o(()=>e[27]||(e[27]=[r("Duration")])),_:1}),i("div",Ne,[i("div",Ee,[s(t(f),{for:"hours",class:"text-xs text-muted-foreground"},{default:o(()=>e[28]||(e[28]=[r("Hours")])),_:1}),s(t(U),{id:"hours",type:"number",min:"0",max:"99",value:b.value,onInput:e[4]||(e[4]=l=>N("hours",l.target.value)),placeholder:"0",class:"text-center"},null,8,["value"])]),i("div",Pe,[s(t(f),{for:"minutes",class:"text-xs text-muted-foreground"},{default:o(()=>e[29]||(e[29]=[r("Minutes")])),_:1}),s(t(U),{id:"minutes",type:"number",min:"0",max:"59",value:_.value,onInput:e[5]||(e[5]=l=>N("minutes",l.target.value)),placeholder:"0",class:"text-center"},null,8,["value"])]),i("div",je,[s(t(f),{for:"seconds",class:"text-xs text-muted-foreground"},{default:o(()=>e[30]||(e[30]=[r("Seconds")])),_:1}),s(t(U),{id:"seconds",type:"number",min:"0",max:"59",value:x.value,onInput:e[6]||(e[6]=l=>N("seconds",l.target.value)),placeholder:"0",class:"text-center"},null,8,["value"])])]),i("div",Be,[i("div",Ge,[s(t(he),{class:"h-4 w-4 text-muted-foreground"}),e[31]||(e[31]=i("span",{class:"text-sm font-medium"},"Total Duration:",-1)),i("span",We,p(Y.value),1)]),b.value>0||_.value>0||x.value>0?(d(),fe(t(n),{key:0,onClick:X,variant:"ghost",size:"sm",type:"button"},{default:o(()=>[s(t(E),{class:"h-4 w-4"})]),_:1})):c("",!0)]),i("div",qe,[s(t(f),{class:"text-xs text-muted-foreground"},{default:o(()=>e[32]||(e[32]=[r("Quick Presets:")])),_:1}),i("div",He,[s(t(n),{onClick:e[7]||(e[7]=l=>k(0,5,0)),variant:"outline",size:"sm",type:"button"},{default:o(()=>e[33]||(e[33]=[r(" 5 min ")])),_:1}),s(t(n),{onClick:e[8]||(e[8]=l=>k(0,10,0)),variant:"outline",size:"sm",type:"button"},{default:o(()=>e[34]||(e[34]=[r(" 10 min ")])),_:1}),s(t(n),{onClick:e[9]||(e[9]=l=>k(0,15,0)),variant:"outline",size:"sm",type:"button"},{default:o(()=>e[35]||(e[35]=[r(" 15 min ")])),_:1}),s(t(n),{onClick:e[10]||(e[10]=l=>k(0,30,0)),variant:"outline",size:"sm",type:"button"},{default:o(()=>e[36]||(e[36]=[r(" 30 min ")])),_:1}),s(t(n),{onClick:e[11]||(e[11]=l=>k(1,0,0)),variant:"outline",size:"sm",type:"button"},{default:o(()=>e[37]||(e[37]=[r(" 1 hour ")])),_:1}),s(t(n),{onClick:e[12]||(e[12]=l=>k(2,0,0)),variant:"outline",size:"sm",type:"button"},{default:o(()=>e[38]||(e[38]=[r(" 2 hours ")])),_:1})])]),t(a).errors.duration?(d(),m("div",Oe,p(t(a).errors.duration),1)):c("",!0),e[39]||(e[39]=i("div",{class:"text-sm text-muted-foreground"}," Enter the audio duration using separate fields for hours, minutes, and seconds ",-1))])]),_:1})]),_:1}),s(t(V),null,{default:o(()=>[s(t(z),null,{default:o(()=>[s(t(L),{class:"flex items-center gap-2"},{default:o(()=>[s(t(ye),{class:"h-5 w-5"}),e[40]||(e[40]=r(" Thumbnail Image "))]),_:1}),s(t(M),null,{default:o(()=>e[41]||(e[41]=[r(" Update the thumbnail image or provide an external URL ")])),_:1})]),_:1}),s(t(R),{class:"space-y-4"},{default:o(()=>[t(P)&&!g.value&&!h.value?(d(),m("div",Je,[s(t(f),null,{default:o(()=>e[42]||(e[42]=[r("Current Thumbnail")])),_:1}),i("div",Ke,[i("img",{src:u.audio.thumbnail_url,alt:"Current thumbnail",class:"w-full h-full object-cover"},null,8,Qe)]),i("div",Xe,[s(t(n),{onClick:T,variant:"outline",size:"sm",type:"button"},{default:o(()=>[s(t(F),{class:"h-4 w-4 mr-2"}),e[43]||(e[43]=r(" Replace Image "))]),_:1}),s(t(n),{onClick:j,variant:"outline",size:"sm",type:"button"},{default:o(()=>[s(t(J),{class:"h-4 w-4 mr-2"}),e[44]||(e[44]=r(" Remove Thumbnail "))]),_:1})])])):c("",!0),g.value?(d(),m("div",Ye,[s(t(H),{variant:"destructive"},{default:o(()=>[s(t(J),{class:"h-4 w-4"}),s(t(O),null,{default:o(()=>e[45]||(e[45]=[i("strong",null,"Remove current thumbnail?",-1),i("br",null,null,-1),r(" This action will remove the current thumbnail image. ")])),_:1})]),_:1}),i("div",Ze,[s(t(n),{onClick:j,variant:"outline",size:"sm",type:"button"},{default:o(()=>[s(t(E),{class:"h-4 w-4 mr-2"}),e[46]||(e[46]=r(" Keep Thumbnail "))]),_:1}),s(t(n),{onClick:T,variant:"outline",size:"sm",type:"button"},{default:o(()=>[s(t(F),{class:"h-4 w-4 mr-2"}),e[47]||(e[47]=r(" Upload New Image "))]),_:1})])])):c("",!0),i("div",et,[s(t(f),null,{default:o(()=>e[48]||(e[48]=[r("Upload New Thumbnail")])),_:1}),i("input",{ref_key:"fileInputRef",ref:w,type:"file",accept:"image/*",onChange:ee,class:"hidden"},null,544),!h.value&&(!t(P)||g.value)?(d(),m("div",{key:0,onClick:T,class:$(["border-2 border-dashed border-input rounded-lg p-6 text-center cursor-pointer hover:border-primary transition-colors",{"border-destructive":t(a).errors.thumbnail}])},[s(t(F),{class:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e[49]||(e[49]=i("div",{class:"text-sm font-medium mb-2"},"Click to upload new thumbnail",-1)),e[50]||(e[50]=i("div",{class:"text-xs text-muted-foreground"}," PNG, JPG, GIF, WebP up to 2MB ",-1))],2)):c("",!0),h.value?(d(),m("div",tt,[i("div",st,[i("img",{src:h.value,alt:"New thumbnail preview",class:"w-full h-full object-cover"},null,8,ot),s(t(n),{onClick:te,variant:"destructive",size:"sm",class:"absolute top-2 right-2 h-8 w-8 p-0 rounded-full",type:"button"},{default:o(()=>[s(t(E),{class:"h-4 w-4"})]),_:1})]),i("div",lt,[s(t(n),{onClick:T,variant:"outline",size:"sm",type:"button"},{default:o(()=>[s(t(F),{class:"h-4 w-4 mr-2"}),e[51]||(e[51]=r(" Change Image "))]),_:1})])])):c("",!0),t(a).errors.thumbnail?(d(),m("div",it,p(t(a).errors.thumbnail),1)):c("",!0)]),e[53]||(e[53]=i("div",{class:"flex items-center gap-4 my-4"},[i("div",{class:"flex-1 border-t border-border"}),i("span",{class:"text-sm text-muted-foreground bg-background px-2"},"OR"),i("div",{class:"flex-1 border-t border-border"})],-1)),i("div",at,[s(t(f),{for:"thumbnail_url"},{default:o(()=>e[52]||(e[52]=[r("External Thumbnail URL")])),_:1}),s(t(U),{id:"thumbnail_url",modelValue:t(a).thumbnail_url,"onUpdate:modelValue":e[13]||(e[13]=l=>t(a).thumbnail_url=l),type:"url",placeholder:"https://example.com/thumbnail.jpg",class:$({"border-destructive":t(a).errors.thumbnail_url}),disabled:!!t(a).thumbnail||g.value},null,8,["modelValue","class","disabled"]),t(a).errors.thumbnail_url?(d(),m("div",rt,p(t(a).errors.thumbnail_url),1)):c("",!0),i("div",ut," Alternative: provide an external image URL "+p(t(a).thumbnail||g.value?"(disabled due to file upload/removal)":""),1)])]),_:1})]),_:1}),s(t(V),null,{default:o(()=>[s(t(z),null,{default:o(()=>[s(t(L),{class:"flex items-center gap-2"},{default:o(()=>[s(t(we),{class:"h-5 w-5"}),e[54]||(e[54]=r(" Settings "))]),_:1}),s(t(M),null,{default:o(()=>e[55]||(e[55]=[r(" Configure the visibility and availability of this audio course ")])),_:1})]),_:1}),s(t(R),null,{default:o(()=>[i("div",nt,[i("div",dt,[s(t(f),null,{default:o(()=>e[56]||(e[56]=[r("Active Status")])),_:1}),e[57]||(e[57]=i("div",{class:"text-sm text-muted-foreground"}," Make this audio course available to users ",-1))]),s(t(be),{checked:t(a).is_active,"onUpdate:checked":e[14]||(e[14]=l=>t(a).is_active=l)},null,8,["checked"])])]),_:1})]),_:1}),s(t(H),null,{default:o(()=>[s(t(ke),{class:"h-4 w-4"}),s(t(O),null,{default:o(()=>e[58]||(e[58]=[i("strong",null,"Important:",-1),r(` When updating the Google Drive file, make sure it's set to "Anyone with the link can view" for proper audio streaming. `)])),_:1})]),_:1}),i("div",mt,[s(t(n),{asChild:"",variant:"outline"},{default:o(()=>[s(t(W),{href:`/admin/audio/${u.audio.id}`},{default:o(()=>e[59]||(e[59]=[r(" Cancel ")])),_:1},8,["href"])]),_:1}),s(t(n),{type:"submit",disabled:S.value||t(a).processing},{default:o(()=>[s(t(Ce),{class:"h-4 w-4 mr-2"}),r(" "+p(S.value?"Updating...":"Update Audio Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{Wt as default};
